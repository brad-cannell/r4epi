<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>37 Using the purrr Package | R for Epidemiology</title>
  <meta name="description" content="This is the textbook for Brad Cannell’s Introduction to R Programming for Epidemiologic Research course." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="37 Using the purrr Package | R for Epidemiology" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://brad-cannell.github.io/r4epi/r4epi_icon.png" />
  <meta property="og:description" content="This is the textbook for Brad Cannell’s Introduction to R Programming for Epidemiologic Research course." />
  <meta name="github-repo" content="brad-cannell/r4epi" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="37 Using the purrr Package | R for Epidemiology" />
  
  <meta name="twitter:description" content="This is the textbook for Brad Cannell’s Introduction to R Programming for Epidemiologic Research course." />
  <meta name="twitter:image" content="https://brad-cannell.github.io/r4epi/r4epi_icon.png" />

<meta name="author" content="Brad Cannell" />


<meta name="date" content="2024-07-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="writing-for-loops.html"/>
<link rel="next" href="introduction-to-git-and-github.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0RREBTQ0D9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0RREBTQ0D9');
</script>
<!-- R4Epi Favicons -->
<!-- https://bookdown.org/yihui/rmarkdown-cookbook/favicon.html -->
<!-- Also using Favicon Generator (https://realfavicongenerator.net) -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Epidemiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#goals"><i class="fa fa-check"></i>Goals</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#text-conventions-used-in-this-book"><i class="fa fa-check"></i>Text conventions used in this book</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#other-reading"><i class="fa fa-check"></i>Other reading</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#contributing-to-r4epi"><i class="fa fa-check"></i>Contributing to R4Epi</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#typos"><i class="fa fa-check"></i>Typos</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#issues"><i class="fa fa-check"></i>Issues</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a>
<ul>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html#brad-cannell"><i class="fa fa-check"></i>Brad Cannell</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html#melvin-livingston"><i class="fa fa-check"></i>Melvin Livingston</a></li>
</ul></li>
<li class="part"><span><b>I Getting Started</b></span></li>
<li class="chapter" data-level="1" data-path="installing-r-and-rstudio.html"><a href="installing-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Installing R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installing-r-and-rstudio.html"><a href="installing-r-and-rstudio.html#download-and-install-on-a-mac"><i class="fa fa-check"></i><b>1.1</b> Download and install on a Mac</a></li>
<li class="chapter" data-level="1.2" data-path="installing-r-and-rstudio.html"><a href="installing-r-and-rstudio.html#download-and-install-on-a-pc"><i class="fa fa-check"></i><b>1.2</b> Download and install on a PC</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>2</b> What is R?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-r.html"><a href="what-is-r.html#what-is-data"><i class="fa fa-check"></i><b>2.1</b> What is data?</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-r.html"><a href="what-is-r.html#what-is-r-1"><i class="fa fa-check"></i><b>2.2</b> What is R?</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="what-is-r.html"><a href="what-is-r.html#transferring-data"><i class="fa fa-check"></i><b>2.2.1</b> Transferring data</a></li>
<li class="chapter" data-level="2.2.2" data-path="what-is-r.html"><a href="what-is-r.html#managing-data"><i class="fa fa-check"></i><b>2.2.2</b> Managing data</a></li>
<li class="chapter" data-level="2.2.3" data-path="what-is-r.html"><a href="what-is-r.html#analyzing-data"><i class="fa fa-check"></i><b>2.2.3</b> Analyzing data</a></li>
<li class="chapter" data-level="2.2.4" data-path="what-is-r.html"><a href="what-is-r.html#presenting-data"><i class="fa fa-check"></i><b>2.2.4</b> Presenting data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html"><i class="fa fa-check"></i><b>3</b> Navigating the RStudio Interface</a>
<ul>
<li class="chapter" data-level="3.1" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-console"><i class="fa fa-check"></i><b>3.1</b> The console</a></li>
<li class="chapter" data-level="3.2" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-environment-pane"><i class="fa fa-check"></i><b>3.2</b> The environment pane</a></li>
<li class="chapter" data-level="3.3" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-files-pane"><i class="fa fa-check"></i><b>3.3</b> The files pane</a></li>
<li class="chapter" data-level="3.4" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-source-pane"><i class="fa fa-check"></i><b>3.4</b> The source pane</a></li>
<li class="chapter" data-level="3.5" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#rstudio-preferences"><i class="fa fa-check"></i><b>3.5</b> RStudio preferences</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html"><i class="fa fa-check"></i><b>4</b> Speaking R’s Language</a>
<ul>
<li class="chapter" data-level="4.1" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#r-is-a-language"><i class="fa fa-check"></i><b>4.1</b> R is a <em>language</em></a></li>
<li class="chapter" data-level="4.2" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#the-r-interpreter"><i class="fa fa-check"></i><b>4.2</b> The R interpreter</a></li>
<li class="chapter" data-level="4.3" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#errors"><i class="fa fa-check"></i><b>4.3</b> Errors</a></li>
<li class="chapter" data-level="4.4" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#functions"><i class="fa fa-check"></i><b>4.4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#passing-values-to-function-arguments"><i class="fa fa-check"></i><b>4.4.1</b> Passing values to function arguments</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#objects"><i class="fa fa-check"></i><b>4.5</b> Objects</a></li>
<li class="chapter" data-level="4.6" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#comments"><i class="fa fa-check"></i><b>4.6</b> Comments</a></li>
<li class="chapter" data-level="4.7" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#packages"><i class="fa fa-check"></i><b>4.7</b> Packages</a></li>
<li class="chapter" data-level="4.8" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#programming-style"><i class="fa fa-check"></i><b>4.8</b> Programming style</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lets-get-programming.html"><a href="lets-get-programming.html"><i class="fa fa-check"></i><b>5</b> Let’s Get Programming</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#simulating-data"><i class="fa fa-check"></i><b>5.1</b> Simulating data</a></li>
<li class="chapter" data-level="5.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#vectors"><i class="fa fa-check"></i><b>5.2</b> Vectors</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#vector-types"><i class="fa fa-check"></i><b>5.2.1</b> Vector types</a></li>
<li class="chapter" data-level="5.2.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#double-vectors"><i class="fa fa-check"></i><b>5.2.2</b> Double vectors</a></li>
<li class="chapter" data-level="5.2.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#integer-vectors"><i class="fa fa-check"></i><b>5.2.3</b> Integer vectors</a></li>
<li class="chapter" data-level="5.2.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#logical-vectors"><i class="fa fa-check"></i><b>5.2.4</b> Logical vectors</a></li>
<li class="chapter" data-level="5.2.5" data-path="lets-get-programming.html"><a href="lets-get-programming.html#factor-vectors"><i class="fa fa-check"></i><b>5.2.5</b> Factor vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#data-frames"><i class="fa fa-check"></i><b>5.3</b> Data frames</a></li>
<li class="chapter" data-level="5.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#tibbles"><i class="fa fa-check"></i><b>5.4</b> Tibbles</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-as_tibble-function"><i class="fa fa-check"></i><b>5.4.1</b> The as_tibble function</a></li>
<li class="chapter" data-level="5.4.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-tibble-function"><i class="fa fa-check"></i><b>5.4.2</b> The tibble function</a></li>
<li class="chapter" data-level="5.4.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-tribble-function"><i class="fa fa-check"></i><b>5.4.3</b> The tribble function</a></li>
<li class="chapter" data-level="5.4.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#why-use-tibbles"><i class="fa fa-check"></i><b>5.4.4</b> Why use tibbles</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lets-get-programming.html"><a href="lets-get-programming.html#missing-data"><i class="fa fa-check"></i><b>5.5</b> Missing data</a></li>
<li class="chapter" data-level="5.6" data-path="lets-get-programming.html"><a href="lets-get-programming.html#our-first-analysis"><i class="fa fa-check"></i><b>5.6</b> Our first analysis</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#manual-calculation-of-the-mean"><i class="fa fa-check"></i><b>5.6.1</b> Manual calculation of the mean</a></li>
<li class="chapter" data-level="5.6.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#dollar-sign-notation"><i class="fa fa-check"></i><b>5.6.2</b> Dollar sign notation</a></li>
<li class="chapter" data-level="5.6.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#bracket-notation"><i class="fa fa-check"></i><b>5.6.3</b> Bracket notation</a></li>
<li class="chapter" data-level="5.6.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-sum-function"><i class="fa fa-check"></i><b>5.6.4</b> The sum function</a></li>
<li class="chapter" data-level="5.6.5" data-path="lets-get-programming.html"><a href="lets-get-programming.html#nesting-functions"><i class="fa fa-check"></i><b>5.6.5</b> Nesting functions</a></li>
<li class="chapter" data-level="5.6.6" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-length-function"><i class="fa fa-check"></i><b>5.6.6</b> The length function</a></li>
<li class="chapter" data-level="5.6.7" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-mean-function"><i class="fa fa-check"></i><b>5.6.7</b> The mean function</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lets-get-programming.html"><a href="lets-get-programming.html#some-common-errors"><i class="fa fa-check"></i><b>5.7</b> Some common errors</a></li>
<li class="chapter" data-level="5.8" data-path="lets-get-programming.html"><a href="lets-get-programming.html#summary"><i class="fa fa-check"></i><b>5.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="asking-questions.html"><a href="asking-questions.html"><i class="fa fa-check"></i><b>6</b> Asking Questions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="asking-questions.html"><a href="asking-questions.html#when-should-we-seek-help"><i class="fa fa-check"></i><b>6.1</b> When should we seek help?</a></li>
<li class="chapter" data-level="6.2" data-path="asking-questions.html"><a href="asking-questions.html#where-should-we-seek-help"><i class="fa fa-check"></i><b>6.2</b> Where should we seek help?</a></li>
<li class="chapter" data-level="6.3" data-path="asking-questions.html"><a href="asking-questions.html#how-should-we-seek-help"><i class="fa fa-check"></i><b>6.3</b> How should we seek help?</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="asking-questions.html"><a href="asking-questions.html#creating-a-post-on-stack-overflow"><i class="fa fa-check"></i><b>6.3.1</b> Creating a post on Stack Overflow</a></li>
<li class="chapter" data-level="6.3.2" data-path="asking-questions.html"><a href="asking-questions.html#creating-better-posts-and-asking-better-questions"><i class="fa fa-check"></i><b>6.3.2</b> Creating better posts and asking better questions</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="asking-questions.html"><a href="asking-questions.html#helping-others"><i class="fa fa-check"></i><b>6.4</b> Helping others</a></li>
<li class="chapter" data-level="6.5" data-path="asking-questions.html"><a href="asking-questions.html#summary-1"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>II Coding Tools and Best Practices</b></span></li>
<li class="chapter" data-level="7" data-path="r-scripts.html"><a href="r-scripts.html"><i class="fa fa-check"></i><b>7</b> R Scripts</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-scripts.html"><a href="r-scripts.html#creating-r-scripts"><i class="fa fa-check"></i><b>7.1</b> Creating R scripts</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quarto-files.html"><a href="quarto-files.html"><i class="fa fa-check"></i><b>8</b> Quarto Files</a>
<ul>
<li class="chapter" data-level="8.1" data-path="quarto-files.html"><a href="quarto-files.html#what-is-quarto"><i class="fa fa-check"></i><b>8.1</b> What is Quarto?</a></li>
<li class="chapter" data-level="8.2" data-path="quarto-files.html"><a href="quarto-files.html#why-use-quarto"><i class="fa fa-check"></i><b>8.2</b> Why use Quarto?</a></li>
<li class="chapter" data-level="8.3" data-path="quarto-files.html"><a href="quarto-files.html#create-a-quarto-file"><i class="fa fa-check"></i><b>8.3</b> Create a Quarto file</a></li>
<li class="chapter" data-level="8.4" data-path="quarto-files.html"><a href="quarto-files.html#yaml-headers"><i class="fa fa-check"></i><b>8.4</b> YAML headers</a></li>
<li class="chapter" data-level="8.5" data-path="quarto-files.html"><a href="quarto-files.html#r-code-chunks"><i class="fa fa-check"></i><b>8.5</b> R code chunks</a></li>
<li class="chapter" data-level="8.6" data-path="quarto-files.html"><a href="quarto-files.html#markdown"><i class="fa fa-check"></i><b>8.6</b> Markdown</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="quarto-files.html"><a href="quarto-files.html#markdown-headings"><i class="fa fa-check"></i><b>8.6.1</b> Markdown headings</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="quarto-files.html"><a href="quarto-files.html#summary-2"><i class="fa fa-check"></i><b>8.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-projects.html"><a href="r-projects.html"><i class="fa fa-check"></i><b>9</b> R Projects</a></li>
<li class="chapter" data-level="10" data-path="coding-best-practices.html"><a href="coding-best-practices.html"><i class="fa fa-check"></i><b>10</b> Coding Best Practices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="coding-best-practices.html"><a href="coding-best-practices.html#general-principles"><i class="fa fa-check"></i><b>10.1</b> General principles</a></li>
<li class="chapter" data-level="10.2" data-path="coding-best-practices.html"><a href="coding-best-practices.html#code-comments"><i class="fa fa-check"></i><b>10.2</b> Code comments</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="coding-best-practices.html"><a href="coding-best-practices.html#defining-key-variables"><i class="fa fa-check"></i><b>10.2.1</b> Defining key variables</a></li>
<li class="chapter" data-level="10.2.2" data-path="coding-best-practices.html"><a href="coding-best-practices.html#what-this-code-is-trying-to-accomplish"><i class="fa fa-check"></i><b>10.2.2</b> What this code is trying to accomplish</a></li>
<li class="chapter" data-level="10.2.3" data-path="coding-best-practices.html"><a href="coding-best-practices.html#why-i-chose-this-particular-strategy"><i class="fa fa-check"></i><b>10.2.3</b> Why I chose this particular strategy</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="coding-best-practices.html"><a href="coding-best-practices.html#style-guidelines"><i class="fa fa-check"></i><b>10.3</b> Style guidelines</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="coding-best-practices.html"><a href="coding-best-practices.html#comments-1"><i class="fa fa-check"></i><b>10.3.1</b> Comments</a></li>
<li class="chapter" data-level="10.3.2" data-path="coding-best-practices.html"><a href="coding-best-practices.html#object-variable-names"><i class="fa fa-check"></i><b>10.3.2</b> Object (variable) names</a></li>
<li class="chapter" data-level="10.3.3" data-path="coding-best-practices.html"><a href="coding-best-practices.html#use-names-that-are-informative"><i class="fa fa-check"></i><b>10.3.3</b> Use names that are informative</a></li>
<li class="chapter" data-level="10.3.4" data-path="coding-best-practices.html"><a href="coding-best-practices.html#file-names"><i class="fa fa-check"></i><b>10.3.4</b> File Names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="using-pipes.html"><a href="using-pipes.html"><i class="fa fa-check"></i><b>11</b> Using Pipes</a>
<ul>
<li class="chapter" data-level="11.1" data-path="using-pipes.html"><a href="using-pipes.html#what-are-pipes"><i class="fa fa-check"></i><b>11.1</b> What are pipes?</a></li>
<li class="chapter" data-level="11.2" data-path="using-pipes.html"><a href="using-pipes.html#how-do-pipes-work"><i class="fa fa-check"></i><b>11.2</b> How do pipes work?</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="using-pipes.html"><a href="using-pipes.html#keyboard-shortcut"><i class="fa fa-check"></i><b>11.2.1</b> Keyboard shortcut</a></li>
<li class="chapter" data-level="11.2.2" data-path="using-pipes.html"><a href="using-pipes.html#pipe-style"><i class="fa fa-check"></i><b>11.2.2</b> Pipe style</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="using-pipes.html"><a href="using-pipes.html#final-thought-on-pipes"><i class="fa fa-check"></i><b>11.3</b> Final thought on pipes</a></li>
</ul></li>
<li class="part"><span><b>III Data Transfer</b></span></li>
<li class="chapter" data-level="12" data-path="introduction-to-data-transfer.html"><a href="introduction-to-data-transfer.html"><i class="fa fa-check"></i><b>12</b> Introduction to Data Transfer</a></li>
<li class="chapter" data-level="13" data-path="file-paths.html"><a href="file-paths.html"><i class="fa fa-check"></i><b>13</b> File Paths</a>
<ul>
<li class="chapter" data-level="13.1" data-path="file-paths.html"><a href="file-paths.html#finding-file-paths"><i class="fa fa-check"></i><b>13.1</b> Finding file paths</a></li>
<li class="chapter" data-level="13.2" data-path="file-paths.html"><a href="file-paths.html#relative-file-paths"><i class="fa fa-check"></i><b>13.2</b> Relative file paths</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html"><i class="fa fa-check"></i><b>14</b> Importing Plain Text Files</a>
<ul>
<li class="chapter" data-level="14.1" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#packages-for-importing-data"><i class="fa fa-check"></i><b>14.1</b> Packages for importing data</a></li>
<li class="chapter" data-level="14.2" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-space-delimited-files"><i class="fa fa-check"></i><b>14.2</b> Importing space delimited files</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#specifying-missing-data-values"><i class="fa fa-check"></i><b>14.2.1</b> Specifying missing data values</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-tab-delimited-files"><i class="fa fa-check"></i><b>14.3</b> Importing tab delimited files</a></li>
<li class="chapter" data-level="14.4" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-fixed-width-format-files"><i class="fa fa-check"></i><b>14.4</b> Importing fixed width format files</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#vector-of-column-widths"><i class="fa fa-check"></i><b>14.4.1</b> Vector of column widths</a></li>
<li class="chapter" data-level="14.4.2" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#paired-vector-of-start-and-end-positions"><i class="fa fa-check"></i><b>14.4.2</b> Paired vector of start and end positions</a></li>
<li class="chapter" data-level="14.4.3" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#using-named-arguments"><i class="fa fa-check"></i><b>14.4.3</b> Using named arguments</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-comma-separated-values-files"><i class="fa fa-check"></i><b>14.5</b> Importing comma separated values files</a></li>
<li class="chapter" data-level="14.6" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#additional-arguments"><i class="fa fa-check"></i><b>14.6</b> Additional arguments</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="importing-binary-files.html"><a href="importing-binary-files.html"><i class="fa fa-check"></i><b>15</b> Importing Binary Files</a>
<ul>
<li class="chapter" data-level="15.1" data-path="importing-binary-files.html"><a href="importing-binary-files.html#packages-for-importing-data-1"><i class="fa fa-check"></i><b>15.1</b> Packages for importing data</a></li>
<li class="chapter" data-level="15.2" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-microsoft-excel-spreadsheets"><i class="fa fa-check"></i><b>15.2</b> Importing Microsoft Excel spreadsheets</a></li>
<li class="chapter" data-level="15.3" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-data-from-other-statistical-analysis-software"><i class="fa fa-check"></i><b>15.3</b> Importing data from other statistical analysis software</a></li>
<li class="chapter" data-level="15.4" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-sas-data-sets"><i class="fa fa-check"></i><b>15.4</b> Importing SAS data sets</a></li>
<li class="chapter" data-level="15.5" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-stata-data-sets"><i class="fa fa-check"></i><b>15.5</b> Importing Stata data sets</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rstudios-data-import-tool.html"><a href="rstudios-data-import-tool.html"><i class="fa fa-check"></i><b>16</b> RStudio’s Data Import Tool</a></li>
<li class="chapter" data-level="17" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>17</b> Exporting Data</a>
<ul>
<li class="chapter" data-level="17.1" data-path="exporting-data.html"><a href="exporting-data.html#plain-text-files"><i class="fa fa-check"></i><b>17.1</b> Plain text files</a></li>
<li class="chapter" data-level="17.2" data-path="exporting-data.html"><a href="exporting-data.html#r-binary-files"><i class="fa fa-check"></i><b>17.2</b> R binary files</a></li>
</ul></li>
<li class="part"><span><b>IV Descriptive Analysis</b></span></li>
<li class="chapter" data-level="18" data-path="introduction-to-descriptive-analysis.html"><a href="introduction-to-descriptive-analysis.html"><i class="fa fa-check"></i><b>18</b> Introduction to Descriptive Analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="introduction-to-descriptive-analysis.html"><a href="introduction-to-descriptive-analysis.html#what-is-descriptive-analysis-and-why-would-we-do-it"><i class="fa fa-check"></i><b>18.1</b> What is descriptive analysis and why would we do it?</a></li>
<li class="chapter" data-level="18.2" data-path="introduction-to-descriptive-analysis.html"><a href="introduction-to-descriptive-analysis.html#what-kind-of-descriptive-analysis-should-we-perform"><i class="fa fa-check"></i><b>18.2</b> What kind of descriptive analysis should we perform?</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html"><i class="fa fa-check"></i><b>19</b> Numerical Descriptions of Categorical Variables</a>
<ul>
<li class="chapter" data-level="19.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#factors"><i class="fa fa-check"></i><b>19.1</b> Factors</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#coerce-a-numeric-variable"><i class="fa fa-check"></i><b>19.1.1</b> Coerce a numeric variable</a></li>
<li class="chapter" data-level="19.1.2" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#coerce-a-character-variable"><i class="fa fa-check"></i><b>19.1.2</b> Coerce a character variable</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#height-and-weight-data"><i class="fa fa-check"></i><b>19.2</b> Height and Weight Data</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#view-the-data"><i class="fa fa-check"></i><b>19.2.1</b> View the data</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#calculating-frequencies"><i class="fa fa-check"></i><b>19.3</b> Calculating frequencies</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#the-base-r-table-function"><i class="fa fa-check"></i><b>19.3.1</b> The base R table function</a></li>
<li class="chapter" data-level="19.3.2" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#the-gmodels-crosstable-function"><i class="fa fa-check"></i><b>19.3.2</b> The gmodels CrossTable function</a></li>
<li class="chapter" data-level="19.3.3" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#the-tidyverse-way"><i class="fa fa-check"></i><b>19.3.3</b> The tidyverse way</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#calculating-percentages"><i class="fa fa-check"></i><b>19.4</b> Calculating percentages</a></li>
<li class="chapter" data-level="19.5" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#cat-missing-data"><i class="fa fa-check"></i><b>19.5</b> Missing data</a></li>
<li class="chapter" data-level="19.6" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#formatting-results"><i class="fa fa-check"></i><b>19.6</b> Formatting results</a></li>
<li class="chapter" data-level="19.7" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#using-freqtables"><i class="fa fa-check"></i><b>19.7</b> Using freqtables</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html"><i class="fa fa-check"></i><b>20</b> Measures of Central Tendency</a>
<ul>
<li class="chapter" data-level="20.1" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#calculate-the-mean"><i class="fa fa-check"></i><b>20.1</b> Calculate the mean</a></li>
<li class="chapter" data-level="20.2" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#calculate-the-median"><i class="fa fa-check"></i><b>20.2</b> Calculate the median</a></li>
<li class="chapter" data-level="20.3" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#calculate-the-mode"><i class="fa fa-check"></i><b>20.3</b> Calculate the mode</a></li>
<li class="chapter" data-level="20.4" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#compare-mean-median-and-mode"><i class="fa fa-check"></i><b>20.4</b> Compare mean, median, and mode</a></li>
<li class="chapter" data-level="20.5" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#data-checking"><i class="fa fa-check"></i><b>20.5</b> Data checking</a></li>
<li class="chapter" data-level="20.6" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#properties-of-mean-median-and-mode"><i class="fa fa-check"></i><b>20.6</b> Properties of mean, median, and mode</a></li>
<li class="chapter" data-level="20.7" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#na-rm"><i class="fa fa-check"></i><b>20.7</b> Missing data</a></li>
<li class="chapter" data-level="20.8" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#using-meantables"><i class="fa fa-check"></i><b>20.8</b> Using meantables</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="measures-of-dispersion.html"><a href="measures-of-dispersion.html"><i class="fa fa-check"></i><b>21</b> Measures of Dispersion</a>
<ul>
<li class="chapter" data-level="21.1" data-path="measures-of-dispersion.html"><a href="measures-of-dispersion.html#comparing-distributions"><i class="fa fa-check"></i><b>21.1</b> Comparing distributions</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><i class="fa fa-check"></i><b>22</b> Describing the Relationship Between a Continuous Outcome and a Continuous Predictor</a>
<ul>
<li class="chapter" data-level="22.1" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>22.1</b> Pearson Correlation Coefficient</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html#calculating-r"><i class="fa fa-check"></i><b>22.1.1</b> Calculating r</a></li>
<li class="chapter" data-level="22.1.2" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html#correlation-intuition"><i class="fa fa-check"></i><b>22.1.2</b> Correlation intuition</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><i class="fa fa-check"></i><b>23</b> Describing the Relationship Between a Continuous Outcome and a Categorical Predictor</a>
<ul>
<li class="chapter" data-level="23.1" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html#single-predictor-and-single-outcome"><i class="fa fa-check"></i><b>23.1</b> Single predictor and single outcome</a></li>
<li class="chapter" data-level="23.2" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html#multiple-predictors"><i class="fa fa-check"></i><b>23.2</b> Multiple predictors</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html"><i class="fa fa-check"></i><b>24</b> Describing the Relationship Between a Categorical Outcome and a Categorical Predictor</a>
<ul>
<li class="chapter" data-level="24.1" data-path="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html#comparing-two-variables"><i class="fa fa-check"></i><b>24.1</b> Comparing two variables</a></li>
</ul></li>
<li class="part"><span><b>V Data Management</b></span></li>
<li class="chapter" data-level="25" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html"><i class="fa fa-check"></i><b>25</b> Introduction to Data Management</a>
<ul>
<li class="chapter" data-level="25.1" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#multiple-paradigms-for-data-management-in-r"><i class="fa fa-check"></i><b>25.1</b> Multiple paradigms for data management in R</a></li>
<li class="chapter" data-level="25.2" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-dplyr-package"><i class="fa fa-check"></i><b>25.2</b> The dplyr package</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-dplyr-verbs"><i class="fa fa-check"></i><b>25.2.1</b> The dplyr verbs</a></li>
<li class="chapter" data-level="25.2.2" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-.data-argument"><i class="fa fa-check"></i><b>25.2.2</b> The .data argument</a></li>
<li class="chapter" data-level="25.2.3" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-argument"><i class="fa fa-check"></i><b>25.2.3</b> The … argument</a></li>
<li class="chapter" data-level="25.2.4" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#non-standard-evaluation"><i class="fa fa-check"></i><b>25.2.4</b> Non-standard evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html"><i class="fa fa-check"></i><b>26</b> Creating and Modifying Columns</a>
<ul>
<li class="chapter" data-level="26.1" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#creating-data-frames"><i class="fa fa-check"></i><b>26.1</b> Creating data frames</a></li>
<li class="chapter" data-level="26.2" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#dollar-sign-notation-1"><i class="fa fa-check"></i><b>26.2</b> Dollar sign notation</a></li>
<li class="chapter" data-level="26.3" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#bracket-notation-1"><i class="fa fa-check"></i><b>26.3</b> Bracket notation</a></li>
<li class="chapter" data-level="26.4" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#modify-individual-values"><i class="fa fa-check"></i><b>26.4</b> Modify individual values</a></li>
<li class="chapter" data-level="26.5" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#the-mutate-function"><i class="fa fa-check"></i><b>26.5</b> The mutate() function</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#adding-or-modifying-a-single-column"><i class="fa fa-check"></i><b>26.5.1</b> Adding or modifying a single column</a></li>
<li class="chapter" data-level="26.5.2" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#recycling-rules"><i class="fa fa-check"></i><b>26.5.2</b> Recycling rules</a></li>
<li class="chapter" data-level="26.5.3" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#using-existing-variables-in-name-value-pairs"><i class="fa fa-check"></i><b>26.5.3</b> Using existing variables in name-value pairs</a></li>
<li class="chapter" data-level="26.5.4" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#adding-or-modifying-multiple-columns"><i class="fa fa-check"></i><b>26.5.4</b> Adding or modifying multiple columns</a></li>
<li class="chapter" data-level="26.5.5" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#rowwise-mutations"><i class="fa fa-check"></i><b>26.5.5</b> Rowwise mutations</a></li>
<li class="chapter" data-level="26.5.6" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#group_by-mutations"><i class="fa fa-check"></i><b>26.5.6</b> Group_by mutations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html"><i class="fa fa-check"></i><b>27</b> Subsetting Data Frames</a>
<ul>
<li class="chapter" data-level="27.1" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-select-function"><i class="fa fa-check"></i><b>27.1</b> The select() function</a></li>
<li class="chapter" data-level="27.2" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-rename-function"><i class="fa fa-check"></i><b>27.2</b> The rename() function</a></li>
<li class="chapter" data-level="27.3" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-filter-function"><i class="fa fa-check"></i><b>27.3</b> The filter() function</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#subgroup-analysis"><i class="fa fa-check"></i><b>27.3.1</b> Subgroup analysis</a></li>
<li class="chapter" data-level="27.3.2" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#complete-case-analysis"><i class="fa fa-check"></i><b>27.3.2</b> Complete case analysis</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#deduplication"><i class="fa fa-check"></i><b>27.4</b> Deduplication</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-distinct-function"><i class="fa fa-check"></i><b>27.4.1</b> The distinct() function</a></li>
<li class="chapter" data-level="27.4.2" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#complete-duplicate-row-add-tag"><i class="fa fa-check"></i><b>27.4.2</b> Complete duplicate row add tag</a></li>
<li class="chapter" data-level="27.4.3" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#partial-duplicate-rows"><i class="fa fa-check"></i><b>27.4.3</b> Partial duplicate rows</a></li>
<li class="chapter" data-level="27.4.4" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#partial-duplicate-rows---add-tag"><i class="fa fa-check"></i><b>27.4.4</b> Partial duplicate rows - add tag</a></li>
<li class="chapter" data-level="27.4.5" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#count-the-number-of-duplicates"><i class="fa fa-check"></i><b>27.4.5</b> Count the number of duplicates</a></li>
<li class="chapter" data-level="27.4.6" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#what-to-do-about-duplicates"><i class="fa fa-check"></i><b>27.4.6</b> What to do about duplicates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="working-with-dates.html"><a href="working-with-dates.html"><i class="fa fa-check"></i><b>28</b> Working with Dates</a>
<ul>
<li class="chapter" data-level="28.1" data-path="working-with-dates.html"><a href="working-with-dates.html#date-vector-types"><i class="fa fa-check"></i><b>28.1</b> Date vector types</a></li>
<li class="chapter" data-level="28.2" data-path="working-with-dates.html"><a href="working-with-dates.html#dates-under-the-hood"><i class="fa fa-check"></i><b>28.2</b> Dates under the hood</a></li>
<li class="chapter" data-level="28.3" data-path="working-with-dates.html"><a href="working-with-dates.html#coercing-date-times-to-dates"><i class="fa fa-check"></i><b>28.3</b> Coercing date-times to dates</a></li>
<li class="chapter" data-level="28.4" data-path="working-with-dates.html"><a href="working-with-dates.html#coercing-character-strings-to-dates"><i class="fa fa-check"></i><b>28.4</b> Coercing character strings to dates</a></li>
<li class="chapter" data-level="28.5" data-path="working-with-dates.html"><a href="working-with-dates.html#change-the-appearance-of-dates-with-format"><i class="fa fa-check"></i><b>28.5</b> Change the appearance of dates with format()</a></li>
<li class="chapter" data-level="28.6" data-path="working-with-dates.html"><a href="working-with-dates.html#some-useful-built-in-dates"><i class="fa fa-check"></i><b>28.6</b> Some useful built-in dates</a>
<ul>
<li class="chapter" data-level="28.6.1" data-path="working-with-dates.html"><a href="working-with-dates.html#todays-date"><i class="fa fa-check"></i><b>28.6.1</b> Today’s date</a></li>
<li class="chapter" data-level="28.6.2" data-path="working-with-dates.html"><a href="working-with-dates.html#todays-date-time"><i class="fa fa-check"></i><b>28.6.2</b> Today’s date-time</a></li>
<li class="chapter" data-level="28.6.3" data-path="working-with-dates.html"><a href="working-with-dates.html#character-vector-of-full-month-names"><i class="fa fa-check"></i><b>28.6.3</b> Character vector of full month names</a></li>
<li class="chapter" data-level="28.6.4" data-path="working-with-dates.html"><a href="working-with-dates.html#character-vector-of-abbreviated-month-names"><i class="fa fa-check"></i><b>28.6.4</b> Character vector of abbreviated month names</a></li>
<li class="chapter" data-level="28.6.5" data-path="working-with-dates.html"><a href="working-with-dates.html#creating-a-vector-containing-a-sequence-of-dates"><i class="fa fa-check"></i><b>28.6.5</b> Creating a vector containing a sequence of dates</a></li>
</ul></li>
<li class="chapter" data-level="28.7" data-path="working-with-dates.html"><a href="working-with-dates.html#calculating-date-intervals"><i class="fa fa-check"></i><b>28.7</b> Calculating date intervals</a>
<ul>
<li class="chapter" data-level="28.7.1" data-path="working-with-dates.html"><a href="working-with-dates.html#calculate-age-as-the-difference-in-time-between-dob-and-today"><i class="fa fa-check"></i><b>28.7.1</b> Calculate age as the difference in time between dob and today</a></li>
<li class="chapter" data-level="28.7.2" data-path="working-with-dates.html"><a href="working-with-dates.html#rounding-time-intervals"><i class="fa fa-check"></i><b>28.7.2</b> Rounding time intervals</a></li>
</ul></li>
<li class="chapter" data-level="28.8" data-path="working-with-dates.html"><a href="working-with-dates.html#extracting-out-date-parts"><i class="fa fa-check"></i><b>28.8</b> Extracting out date parts</a></li>
<li class="chapter" data-level="28.9" data-path="working-with-dates.html"><a href="working-with-dates.html#sorting-dates"><i class="fa fa-check"></i><b>28.9</b> Sorting dates</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html"><i class="fa fa-check"></i><b>29</b> Working with Character Strings</a>
<ul>
<li class="chapter" data-level="29.1" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#coerce-to-lowercase"><i class="fa fa-check"></i><b>29.1</b> Coerce to lowercase</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#lowercase"><i class="fa fa-check"></i><b>29.1.1</b> Lowercase</a></li>
<li class="chapter" data-level="29.1.2" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#upper-case"><i class="fa fa-check"></i><b>29.1.2</b> Upper case</a></li>
<li class="chapter" data-level="29.1.3" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#title-case"><i class="fa fa-check"></i><b>29.1.3</b> Title case</a></li>
<li class="chapter" data-level="29.1.4" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#sentence-case"><i class="fa fa-check"></i><b>29.1.4</b> Sentence case</a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#trim-white-space"><i class="fa fa-check"></i><b>29.2</b> Trim white space</a></li>
<li class="chapter" data-level="29.3" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#regular-expressions"><i class="fa fa-check"></i><b>29.3</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="29.3.1" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#remove-the-comma"><i class="fa fa-check"></i><b>29.3.1</b> Remove the comma</a></li>
<li class="chapter" data-level="29.3.2" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#remove-middle-initial"><i class="fa fa-check"></i><b>29.3.2</b> Remove middle initial</a></li>
<li class="chapter" data-level="29.3.3" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#remove-double-spaces"><i class="fa fa-check"></i><b>29.3.3</b> Remove double spaces</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#separate-values-into-component-parts"><i class="fa fa-check"></i><b>29.4</b> Separate values into component parts</a></li>
<li class="chapter" data-level="29.5" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#dummy-variables"><i class="fa fa-check"></i><b>29.5</b> Dummy variables</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="conditional-operations.html"><a href="conditional-operations.html"><i class="fa fa-check"></i><b>30</b> Conditional Operations</a>
<ul>
<li class="chapter" data-level="30.1" data-path="conditional-operations.html"><a href="conditional-operations.html#operands-and-operators"><i class="fa fa-check"></i><b>30.1</b> Operands and operators</a></li>
<li class="chapter" data-level="30.2" data-path="conditional-operations.html"><a href="conditional-operations.html#testing-multiple-conditions-simultaneously"><i class="fa fa-check"></i><b>30.2</b> Testing multiple conditions simultaneously</a></li>
<li class="chapter" data-level="30.3" data-path="conditional-operations.html"><a href="conditional-operations.html#testing-a-sequence-of-conditions"><i class="fa fa-check"></i><b>30.3</b> Testing a sequence of conditions</a></li>
<li class="chapter" data-level="30.4" data-path="conditional-operations.html"><a href="conditional-operations.html#recoding-variables"><i class="fa fa-check"></i><b>30.4</b> Recoding variables</a></li>
<li class="chapter" data-level="30.5" data-path="conditional-operations.html"><a href="conditional-operations.html#case_when-is-lazy"><i class="fa fa-check"></i><b>30.5</b> case_when() is lazy</a></li>
<li class="chapter" data-level="30.6" data-path="conditional-operations.html"><a href="conditional-operations.html#recode-missing"><i class="fa fa-check"></i><b>30.6</b> Recode missing</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html"><i class="fa fa-check"></i><b>31</b> Working with Multiple Data Frames</a>
<ul>
<li class="chapter" data-level="31.1" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-vertically-adding-rows"><i class="fa fa-check"></i><b>31.1</b> Combining data frames vertically: Adding rows</a>
<ul>
<li class="chapter" data-level="31.1.1" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-more-than-2-data-frames"><i class="fa fa-check"></i><b>31.1.1</b> Combining more than 2 data frames</a></li>
<li class="chapter" data-level="31.1.2" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#adding-rows-with-differing-columns"><i class="fa fa-check"></i><b>31.1.2</b> Adding rows with differing columns</a></li>
<li class="chapter" data-level="31.1.3" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#differing-column-positions"><i class="fa fa-check"></i><b>31.1.3</b> Differing column positions</a></li>
<li class="chapter" data-level="31.1.4" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#differing-column-names"><i class="fa fa-check"></i><b>31.1.4</b> Differing column names</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-horizontally-adding-columns"><i class="fa fa-check"></i><b>31.2</b> Combining data frames horizontally: Adding columns</a>
<ul>
<li class="chapter" data-level="31.2.1" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-horizontally-by-position"><i class="fa fa-check"></i><b>31.2.1</b> Combining data frames horizontally by position</a></li>
<li class="chapter" data-level="31.2.2" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-horizontally-by-key-values"><i class="fa fa-check"></i><b>31.2.2</b> Combining data frames horizontally by key values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html"><i class="fa fa-check"></i><b>32</b> Restructuring Data frames</a>
<ul>
<li class="chapter" data-level="32.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-tidyr-package"><i class="fa fa-check"></i><b>32.1</b> The tidyr package</a></li>
<li class="chapter" data-level="32.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-longer"><i class="fa fa-check"></i><b>32.2</b> Pivoting longer</a>
<ul>
<li class="chapter" data-level="32.2.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_to-argument"><i class="fa fa-check"></i><b>32.2.1</b> The names_to argument</a></li>
<li class="chapter" data-level="32.2.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_prefix-argument"><i class="fa fa-check"></i><b>32.2.2</b> The names_prefix argument</a></li>
<li class="chapter" data-level="32.2.3" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-values_to-argument"><i class="fa fa-check"></i><b>32.2.3</b> The values_to argument</a></li>
<li class="chapter" data-level="32.2.4" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_transform-argument"><i class="fa fa-check"></i><b>32.2.4</b> The names_transform argument</a></li>
<li class="chapter" data-level="32.2.5" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-multiple-sets-of-columns"><i class="fa fa-check"></i><b>32.2.5</b> Pivoting multiple sets of columns</a></li>
<li class="chapter" data-level="32.2.6" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_sep-argument"><i class="fa fa-check"></i><b>32.2.6</b> The names_sep argument</a></li>
<li class="chapter" data-level="32.2.7" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-.value-special-value"><i class="fa fa-check"></i><b>32.2.7</b> The .value special value</a></li>
<li class="chapter" data-level="32.2.8" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#why-person-period"><i class="fa fa-check"></i><b>32.2.8</b> Why person-period?</a></li>
</ul></li>
<li class="chapter" data-level="32.3" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-wider"><i class="fa fa-check"></i><b>32.3</b> Pivoting wider</a>
<ul>
<li class="chapter" data-level="32.3.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#why-person-level"><i class="fa fa-check"></i><b>32.3.1</b> Why person-level?</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-summary-statistics"><i class="fa fa-check"></i><b>32.4</b> Pivoting summary statistics</a>
<ul>
<li class="chapter" data-level="32.4.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-summary-statistics-wide-to-long"><i class="fa fa-check"></i><b>32.4.1</b> Pivoting summary statistics wide to long</a></li>
<li class="chapter" data-level="32.4.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-summary-statistics-long-to-wide"><i class="fa fa-check"></i><b>32.4.2</b> Pivoting summary statistics long to wide</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#tidy-data"><i class="fa fa-check"></i><b>32.5</b> Tidy data</a>
<ul>
<li class="chapter" data-level="32.5.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#each-variable-must-have-its-own-column"><i class="fa fa-check"></i><b>32.5.1</b> Each variable must have its own column</a></li>
<li class="chapter" data-level="32.5.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#each-observation-must-have-its-own-row"><i class="fa fa-check"></i><b>32.5.2</b> Each observation must have its own row</a></li>
<li class="chapter" data-level="32.5.3" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#each-value-must-have-its-own-cell"><i class="fa fa-check"></i><b>32.5.3</b> Each value must have its own cell</a></li>
</ul></li>
<li class="chapter" data-level="32.6" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-complete-function"><i class="fa fa-check"></i><b>32.6</b> The complete() function</a></li>
</ul></li>
<li class="part"><span><b>VI Repeated Operations</b></span></li>
<li class="chapter" data-level="33" data-path="introduction-to-repeated-operations.html"><a href="introduction-to-repeated-operations.html"><i class="fa fa-check"></i><b>33</b> Introduction to Repeated Operations</a>
<ul>
<li class="chapter" data-level="33.1" data-path="introduction-to-repeated-operations.html"><a href="introduction-to-repeated-operations.html#multiple-methods-for-repeated-operations-in-r"><i class="fa fa-check"></i><b>33.1</b> Multiple methods for repeated operations in R</a></li>
<li class="chapter" data-level="33.2" data-path="introduction-to-repeated-operations.html"><a href="introduction-to-repeated-operations.html#tidy-evaluation"><i class="fa fa-check"></i><b>33.2</b> Tidy evaluation</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="writing-functions.html"><a href="writing-functions.html"><i class="fa fa-check"></i><b>34</b> Writing Functions</a>
<ul>
<li class="chapter" data-level="34.1" data-path="writing-functions.html"><a href="writing-functions.html#when-to-write-functions"><i class="fa fa-check"></i><b>34.1</b> When to write functions</a></li>
<li class="chapter" data-level="34.2" data-path="writing-functions.html"><a href="writing-functions.html#how-to-write-functions"><i class="fa fa-check"></i><b>34.2</b> How to write functions</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="writing-functions.html"><a href="writing-functions.html#the-function-function"><i class="fa fa-check"></i><b>34.2.1</b> The function() function</a></li>
<li class="chapter" data-level="34.2.2" data-path="writing-functions.html"><a href="writing-functions.html#the-function-writing-process"><i class="fa fa-check"></i><b>34.2.2</b> The function writing process</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="writing-functions.html"><a href="writing-functions.html#giving-your-function-arguments-default-values"><i class="fa fa-check"></i><b>34.3</b> Giving your function arguments default values</a></li>
<li class="chapter" data-level="34.4" data-path="writing-functions.html"><a href="writing-functions.html#the-values-your-functions-return"><i class="fa fa-check"></i><b>34.4</b> The values your functions return</a></li>
<li class="chapter" data-level="34.5" data-path="writing-functions.html"><a href="writing-functions.html#lexical-scoping-and-functions"><i class="fa fa-check"></i><b>34.5</b> Lexical scoping and functions</a></li>
<li class="chapter" data-level="34.6" data-path="writing-functions.html"><a href="writing-functions.html#tidy-evaluation-1"><i class="fa fa-check"></i><b>34.6</b> Tidy evaluation</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html"><i class="fa fa-check"></i><b>35</b> Column-wise Operations in dplyr</a>
<ul>
<li class="chapter" data-level="35.1" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#the-across-function"><i class="fa fa-check"></i><b>35.1</b> The across() function</a></li>
<li class="chapter" data-level="35.2" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#across-with-mutate"><i class="fa fa-check"></i><b>35.2</b> Across with mutate</a></li>
<li class="chapter" data-level="35.3" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#across-with-summarise"><i class="fa fa-check"></i><b>35.3</b> Across with summarise</a></li>
<li class="chapter" data-level="35.4" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#across-with-filter"><i class="fa fa-check"></i><b>35.4</b> Across with filter</a></li>
<li class="chapter" data-level="35.5" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#summary-3"><i class="fa fa-check"></i><b>35.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="writing-for-loops.html"><a href="writing-for-loops.html"><i class="fa fa-check"></i><b>36</b> Writing For Loops</a>
<ul>
<li class="chapter" data-level="36.1" data-path="writing-for-loops.html"><a href="writing-for-loops.html#how-to-write-for-loops"><i class="fa fa-check"></i><b>36.1</b> How to write for loops</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="writing-for-loops.html"><a href="writing-for-loops.html#the-for-loop-body"><i class="fa fa-check"></i><b>36.1.1</b> The for loop body</a></li>
<li class="chapter" data-level="36.1.2" data-path="writing-for-loops.html"><a href="writing-for-loops.html#the-for-function"><i class="fa fa-check"></i><b>36.1.2</b> The for() function</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="writing-for-loops.html"><a href="writing-for-loops.html#using-for-loops-for-data-transfer"><i class="fa fa-check"></i><b>36.2</b> Using for loops for data transfer</a></li>
<li class="chapter" data-level="36.3" data-path="writing-for-loops.html"><a href="writing-for-loops.html#using-for-loops-for-data-management"><i class="fa fa-check"></i><b>36.3</b> Using for loops for data management</a></li>
<li class="chapter" data-level="36.4" data-path="writing-for-loops.html"><a href="writing-for-loops.html#using-for-loops-for-analysis"><i class="fa fa-check"></i><b>36.4</b> Using for loops for analysis</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html"><i class="fa fa-check"></i><b>37</b> Using the purrr Package</a>
<ul>
<li class="chapter" data-level="37.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#comparing-for-loops-and-the-map-functions"><i class="fa fa-check"></i><b>37.1</b> Comparing for loops and the map functions</a></li>
<li class="chapter" data-level="37.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#using-purrr-for-data-transfer"><i class="fa fa-check"></i><b>37.2</b> Using purrr for data transfer</a>
<ul>
<li class="chapter" data-level="37.2.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-1-importing-multiple-sheets-from-an-excel-workbook"><i class="fa fa-check"></i><b>37.2.1</b> Example 1: Importing multiple sheets from an Excel workbook</a></li>
<li class="chapter" data-level="37.2.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#why-walk-instead-of-map"><i class="fa fa-check"></i><b>37.2.2</b> Why walk instead of map?</a></li>
<li class="chapter" data-level="37.2.3" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#why-we-didnt-assign-the-return-value-of-walk-to-an-object"><i class="fa fa-check"></i><b>37.2.3</b> why we didn’t assign the return value of <code>walk()</code> to an object?</a></li>
</ul></li>
<li class="chapter" data-level="37.3" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#using-purrr-for-data-management"><i class="fa fa-check"></i><b>37.3</b> Using purrr for data management</a>
<ul>
<li class="chapter" data-level="37.3.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-1-adding-na-at-multiple-positions"><i class="fa fa-check"></i><b>37.3.1</b> Example 1: Adding NA at multiple positions</a></li>
<li class="chapter" data-level="37.3.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-2.-detecting-matching-values-by-position"><i class="fa fa-check"></i><b>37.3.2</b> Example 2. Detecting matching values by position</a></li>
</ul></li>
<li class="chapter" data-level="37.4" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#using-purrr-for-analysis"><i class="fa fa-check"></i><b>37.4</b> Using purrr for analysis</a>
<ul>
<li class="chapter" data-level="37.4.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-1-continuous-statistics"><i class="fa fa-check"></i><b>37.4.1</b> Example 1: Continuous statistics</a></li>
<li class="chapter" data-level="37.4.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-2-categorical-statistics"><i class="fa fa-check"></i><b>37.4.2</b> Example 2: Categorical statistics</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Collaboration</b></span></li>
<li class="chapter" data-level="38" data-path="introduction-to-git-and-github.html"><a href="introduction-to-git-and-github.html"><i class="fa fa-check"></i><b>38</b> Introduction to git and GitHub</a>
<ul>
<li class="chapter" data-level="38.1" data-path="introduction-to-git-and-github.html"><a href="introduction-to-git-and-github.html#versioning"><i class="fa fa-check"></i><b>38.1</b> Versioning</a></li>
<li class="chapter" data-level="38.2" data-path="introduction-to-git-and-github.html"><a href="introduction-to-git-and-github.html#preservation"><i class="fa fa-check"></i><b>38.2</b> Preservation</a></li>
<li class="chapter" data-level="38.3" data-path="introduction-to-git-and-github.html"><a href="introduction-to-git-and-github.html#reproducibility"><i class="fa fa-check"></i><b>38.3</b> Reproducibility</a></li>
<li class="chapter" data-level="38.4" data-path="introduction-to-git-and-github.html"><a href="introduction-to-git-and-github.html#collaboration"><i class="fa fa-check"></i><b>38.4</b> Collaboration</a></li>
<li class="chapter" data-level="38.5" data-path="introduction-to-git-and-github.html"><a href="introduction-to-git-and-github.html#summary-4"><i class="fa fa-check"></i><b>38.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="using-git-and-github.html"><a href="using-git-and-github.html"><i class="fa fa-check"></i><b>39</b> Using git and GitHub</a>
<ul>
<li class="chapter" data-level="39.1" data-path="using-git-and-github.html"><a href="using-git-and-github.html#install-git"><i class="fa fa-check"></i><b>39.1</b> Install git</a></li>
<li class="chapter" data-level="39.2" data-path="using-git-and-github.html"><a href="using-git-and-github.html#sign-up-for-a-github-account"><i class="fa fa-check"></i><b>39.2</b> Sign up for a GitHub account</a></li>
<li class="chapter" data-level="39.3" data-path="using-git-and-github.html"><a href="using-git-and-github.html#install-gitkraken"><i class="fa fa-check"></i><b>39.3</b> Install GitKraken</a></li>
<li class="chapter" data-level="39.4" data-path="using-git-and-github.html"><a href="using-git-and-github.html#example-1-contribute-to-r4epi"><i class="fa fa-check"></i><b>39.4</b> Example 1: Contribute to R4Epi</a></li>
<li class="chapter" data-level="39.5" data-path="using-git-and-github.html"><a href="using-git-and-github.html#example-2-create-a-repository-for-a-research-project"><i class="fa fa-check"></i><b>39.5</b> Example 2: Create a repository for a research project</a>
<ul>
<li class="chapter" data-level="" data-path="using-git-and-github.html"><a href="using-git-and-github.html#step-1-create-a-repository-on-github"><i class="fa fa-check"></i>Step 1: Create a repository on GitHub</a></li>
<li class="chapter" data-level="" data-path="using-git-and-github.html"><a href="using-git-and-github.html#step-2-clone-the-repository-to-your-computer"><i class="fa fa-check"></i>Step 2: Clone the repository to your computer</a></li>
<li class="chapter" data-level="" data-path="using-git-and-github.html"><a href="using-git-and-github.html#step-3-add-an-r-project-file-to-the-repository"><i class="fa fa-check"></i>Step 3: Add an R project file to the repository</a></li>
<li class="chapter" data-level="" data-path="using-git-and-github.html"><a href="using-git-and-github.html#step-4-update-and-commit-gitignore"><i class="fa fa-check"></i>Step 4: Update and commit gitignore</a></li>
<li class="chapter" data-level="" data-path="using-git-and-github.html"><a href="using-git-and-github.html#step-5-keep-adding-and-committing-files"><i class="fa fa-check"></i>Step 5: Keep adding and committing files</a></li>
</ul></li>
<li class="chapter" data-level="39.6" data-path="using-git-and-github.html"><a href="using-git-and-github.html#committing-and-pushing"><i class="fa fa-check"></i><b>39.6</b> Committing and pushing</a></li>
<li class="chapter" data-level="39.7" data-path="using-git-and-github.html"><a href="using-git-and-github.html#example-3-contribute-to-a-research-project"><i class="fa fa-check"></i><b>39.7</b> Example 3: Contribute to a research project</a>
<ul>
<li class="chapter" data-level="39.7.1" data-path="using-git-and-github.html"><a href="using-git-and-github.html#forking-a-repository"><i class="fa fa-check"></i><b>39.7.1</b> Forking a repository</a></li>
<li class="chapter" data-level="39.7.2" data-path="using-git-and-github.html"><a href="using-git-and-github.html#creating-a-pull-request"><i class="fa fa-check"></i><b>39.7.2</b> Creating a pull request</a></li>
</ul></li>
<li class="chapter" data-level="39.8" data-path="using-git-and-github.html"><a href="using-git-and-github.html#summary-5"><i class="fa fa-check"></i><b>39.8</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>VIII Presenting Results</b></span></li>
<li class="chapter" data-level="40" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html"><i class="fa fa-check"></i><b>40</b> Creating Tables with R and Microsoft Word</a>
<ul>
<li class="chapter" data-level="40.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#table-1"><i class="fa fa-check"></i><b>40.1</b> Table 1</a></li>
<li class="chapter" data-level="40.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#opioid-drug-use"><i class="fa fa-check"></i><b>40.2</b> Opioid drug use</a></li>
<li class="chapter" data-level="40.3" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#table-columns"><i class="fa fa-check"></i><b>40.3</b> Table columns</a></li>
<li class="chapter" data-level="40.4" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#table-rows"><i class="fa fa-check"></i><b>40.4</b> Table rows</a></li>
<li class="chapter" data-level="40.5" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#make-the-table-skeleton"><i class="fa fa-check"></i><b>40.5</b> Make the table skeleton</a></li>
<li class="chapter" data-level="40.6" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-column-headers"><i class="fa fa-check"></i><b>40.6</b> Fill in column headers</a>
<ul>
<li class="chapter" data-level="40.6.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#group-sample-sizes"><i class="fa fa-check"></i><b>40.6.1</b> Group sample sizes</a></li>
<li class="chapter" data-level="40.6.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-column-headers"><i class="fa fa-check"></i><b>40.6.2</b> Formatting column headers</a></li>
</ul></li>
<li class="chapter" data-level="40.7" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-row-headers"><i class="fa fa-check"></i><b>40.7</b> Fill in row headers</a>
<ul>
<li class="chapter" data-level="40.7.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#label-statistics"><i class="fa fa-check"></i><b>40.7.1</b> Label statistics</a></li>
<li class="chapter" data-level="40.7.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-row-headers"><i class="fa fa-check"></i><b>40.7.2</b> Formatting row headers</a></li>
</ul></li>
<li class="chapter" data-level="40.8" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-data-values"><i class="fa fa-check"></i><b>40.8</b> Fill in data values</a>
<ul>
<li class="chapter" data-level="40.8.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#manually-type-values"><i class="fa fa-check"></i><b>40.8.1</b> Manually type values</a></li>
<li class="chapter" data-level="40.8.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#copy-and-paste-values"><i class="fa fa-check"></i><b>40.8.2</b> Copy and paste values</a></li>
<li class="chapter" data-level="40.8.3" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#knit-a-word-document"><i class="fa fa-check"></i><b>40.8.3</b> Knit a Word document</a></li>
<li class="chapter" data-level="40.8.4" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#flextable-and-officer"><i class="fa fa-check"></i><b>40.8.4</b> flextable and officer</a></li>
<li class="chapter" data-level="40.8.5" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#significant-digits"><i class="fa fa-check"></i><b>40.8.5</b> Significant digits</a></li>
<li class="chapter" data-level="40.8.6" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-data-values"><i class="fa fa-check"></i><b>40.8.6</b> Formatting data values</a></li>
</ul></li>
<li class="chapter" data-level="40.9" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-title"><i class="fa fa-check"></i><b>40.9</b> Fill in title</a></li>
<li class="chapter" data-level="40.10" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-footnotes"><i class="fa fa-check"></i><b>40.10</b> Fill in footnotes</a>
<ul>
<li class="chapter" data-level="40.10.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-footnotes"><i class="fa fa-check"></i><b>40.10.1</b> Formatting footnotes</a></li>
</ul></li>
<li class="chapter" data-level="40.11" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#final-formatting"><i class="fa fa-check"></i><b>40.11</b> Final formatting</a>
<ul>
<li class="chapter" data-level="40.11.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#adjust-column-widths"><i class="fa fa-check"></i><b>40.11.1</b> Adjust column widths</a></li>
<li class="chapter" data-level="40.11.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#merge-cells"><i class="fa fa-check"></i><b>40.11.2</b> Merge cells</a></li>
<li class="chapter" data-level="40.11.3" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#remove-cell-borders"><i class="fa fa-check"></i><b>40.11.3</b> Remove cell borders</a></li>
</ul></li>
<li class="chapter" data-level="40.12" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#summary-6"><i class="fa fa-check"></i><b>40.12</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>IX Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html"><i class="fa fa-check"></i>Appendix: Alternative table formats</a>
<ul>
<li class="chapter" data-level="40.13" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#smaller-data-frame"><i class="fa fa-check"></i><b>40.13</b> Smaller data frame</a>
<ul>
<li class="chapter" data-level="40.13.1" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#default-method-for-printing-the-data-frame-to-the-screen"><i class="fa fa-check"></i><b>40.13.1</b> Default method for printing the data frame to the screen</a></li>
<li class="chapter" data-level="40.13.2" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-kable-function"><i class="fa fa-check"></i><b>40.13.2</b> Using the kable function</a></li>
<li class="chapter" data-level="40.13.3" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-datatable-function"><i class="fa fa-check"></i><b>40.13.3</b> Using the datatable function</a></li>
</ul></li>
<li class="chapter" data-level="40.14" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#larger-data-frame"><i class="fa fa-check"></i><b>40.14</b> Larger data frame</a>
<ul>
<li class="chapter" data-level="40.14.1" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#default-method-for-printing-the-data-frame-to-the-screen-1"><i class="fa fa-check"></i><b>40.14.1</b> Default method for printing the data frame to the screen</a></li>
<li class="chapter" data-level="40.14.2" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-kable-function-1"><i class="fa fa-check"></i><b>40.14.2</b> Using the kable function</a></li>
<li class="chapter" data-level="40.14.3" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-datatable-function-1"><i class="fa fa-check"></i><b>40.14.3</b> Using the datatable function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Epidemiology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-the-purrr-package" class="section level1 hasAnchor" number="37">
<h1><span class="header-section-number">37</span> Using the purrr Package<a href="using-the-purrr-package.html#using-the-purrr-package" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--
Hidden comments placeholder
---------------------------

To preview:
bookdown::preview_chapter("chapters/07_part_repeated_operations/05_using_purrr.Rmd")

Copy and paste:
👆**Here's what we did above:**
-->
<p>In this final chapter of the repeated operations part of the book, we are going to discuss the <a href="https://purrr.tidyverse.org/">purrr package</a>.</p>
<p><img src="img/07_part_repeated_operations/01_intro/stickers.png" /><!-- --></p>
<p>The <code>purrr</code> package provides a really robust set of functions that can help us more efficiently complete a bunch of different tasks in R. For the purposes of this chapter, however, we are going to focus on using the <code>purrr::map</code> functions as an alternative approach to removing unnecessary repetition from the various different code chunks we’ve already seen in other chapters.</p>
<p>For our purposes, you can think of the <code>purrr::map</code> functions as a replacement for for loops. In other words, you can think of them as <em>doing</em> the same thing as a for loop, but writing the code in a different way.</p>
<p class="note">
🗒<strong>Side Note:</strong> I also want to mention that the <code>purrr</code> package is closely related to base R’s <code>apply</code> functions (i.e., <code>apply()</code>, <code>lapply()</code>, <code>sapply()</code>, <code>tapply()</code>). We aren’t going to discuss those functions any further, but you will often see them mentioned side-by-side as solutions to a given coding challenge on websites like Stack Overflow. The <code>purrr</code> package is partially meant to be an improved replacement for the <code>apply</code> functions.
</p>
<p>As usual, let’s start by taking a look at a simple example – the same one we used to start the <a href="column-wise-operations-in-dplyr.html#column-wise-operations-in-dplyr">chapter on column-wise operations</a> and the <a href="writing-for-loops.html#writing-for-loops">chapter on writing for loops</a>. Afterwards, we will compare the basic structure of <code>purrr::map</code> functions to the basic structure of for loops. Finally, we will work through a number of the examples we’ve already worked through in this part of the book using the <code>purrr</code> approach.</p>
<p>At this point, we will go ahead and load <code>dplyr</code> and <code>purrr</code> and simulate our data:</p>
<div class="sourceCode" id="cb1557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1557-1"><a href="using-the-purrr-package.html#cb1557-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1557-2"><a href="using-the-purrr-package.html#cb1557-2" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code></pre></div>
<div class="sourceCode" id="cb1558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1558-1"><a href="using-the-purrr-package.html#cb1558-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1558-2"><a href="using-the-purrr-package.html#cb1558-2" tabindex="-1"></a>df_xyz <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1558-3"><a href="using-the-purrr-package.html#cb1558-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb1558-4"><a href="using-the-purrr-package.html#cb1558-4" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb1558-5"><a href="using-the-purrr-package.html#cb1558-5" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb1558-6"><a href="using-the-purrr-package.html#cb1558-6" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1558-7"><a href="using-the-purrr-package.html#cb1558-7" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 -0.230   0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705  0.111 -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  -1.69 
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>In the <a href="column-wise-operations-in-dplyr.html#column-wise-operations-in-dplyr">chapter on column-wise operations</a> we used <code>dplyr</code>’s <code>across()</code> function to efficiently find the mean of each column in the <code>df_xyz</code> data frame:</p>
<div class="sourceCode" id="cb1560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1560-1"><a href="using-the-purrr-package.html#cb1560-1" tabindex="-1"></a>df_xyz <span class="sc">%&gt;%</span></span>
<span id="cb1560-2"><a href="using-the-purrr-package.html#cb1560-2" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1560-3"><a href="using-the-purrr-package.html#cb1560-3" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb1560-4"><a href="using-the-purrr-package.html#cb1560-4" tabindex="-1"></a>      <span class="at">.cols  =</span> <span class="fu">everything</span>(),</span>
<span id="cb1560-5"><a href="using-the-purrr-package.html#cb1560-5" tabindex="-1"></a>      <span class="at">.fns   =</span> mean,</span>
<span id="cb1560-6"><a href="using-the-purrr-package.html#cb1560-6" tabindex="-1"></a>      <span class="at">.names =</span> <span class="st">&quot;{col}_mean&quot;</span></span>
<span id="cb1560-7"><a href="using-the-purrr-package.html#cb1560-7" tabindex="-1"></a>    )</span>
<span id="cb1560-8"><a href="using-the-purrr-package.html#cb1560-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   x_mean y_mean z_mean
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.0746  0.209 -0.425</code></pre>
<p>In the <a href="writing-for-loops.html#writing-for-loops">chapter on writing for loops</a>, we learned an alternative approach that would also work:</p>
<div class="sourceCode" id="cb1562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1562-1"><a href="using-the-purrr-package.html#cb1562-1" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="fu">ncol</span>(df_xyz))</span>
<span id="cb1562-2"><a href="using-the-purrr-package.html#cb1562-2" tabindex="-1"></a></span>
<span id="cb1562-3"><a href="using-the-purrr-package.html#cb1562-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(df_xyz)) {</span>
<span id="cb1562-4"><a href="using-the-purrr-package.html#cb1562-4" tabindex="-1"></a>  xyz_means[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[i]])</span>
<span id="cb1562-5"><a href="using-the-purrr-package.html#cb1562-5" tabindex="-1"></a>}</span>
<span id="cb1562-6"><a href="using-the-purrr-package.html#cb1562-6" tabindex="-1"></a></span>
<span id="cb1562-7"><a href="using-the-purrr-package.html#cb1562-7" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862196 -0.42455887</code></pre>
<p>An alternative way to complete the analysis above is with the <code>map_dbl()</code> function from the <code>purrr</code> package like this:</p>
<div class="sourceCode" id="cb1564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1564-1"><a href="using-the-purrr-package.html#cb1564-1" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb1564-2"><a href="using-the-purrr-package.html#cb1564-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz, </span>
<span id="cb1564-3"><a href="using-the-purrr-package.html#cb1564-3" tabindex="-1"></a>  <span class="at">.f =</span> mean</span>
<span id="cb1564-4"><a href="using-the-purrr-package.html#cb1564-4" tabindex="-1"></a>) </span>
<span id="cb1564-5"><a href="using-the-purrr-package.html#cb1564-5" tabindex="-1"></a></span>
<span id="cb1564-6"><a href="using-the-purrr-package.html#cb1564-6" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>##           x           y           z 
##  0.07462564  0.20862196 -0.42455887</code></pre>
<p>👆<strong>Here’s what we did above:</strong></p>
<ul>
<li><p>We used <code>purr</code>’s <code>map_dbl()</code> function to iteratively calculate the mean of each column in the <code>df_xyz</code> data frame. There are other <code>map</code> functions beside <code>map_dbl()</code>. We will eventually discuss them all.</p></li>
<li><p>You can type <code>?purrr::map_dbl</code> into your R console to view the help documentation for this function and follow along with the explanation below.</p></li>
<li><p>The first argument to all of the <code>map</code> functions is the <code>.x</code> argument. You should pass the name of a list, data frame, or vector that you want to iterate over to the <code>.x</code> argument. If the object passed to the <code>.x</code> argument is a vector, then <code>map</code> will apply the function passed to the <code>.f</code> argument (see below) to each element of the vector. If the object passed to the <code>.x</code> argument is a data frame, then <code>map</code> will apply the function passed to the <code>.f</code> argument to each column of the data frame. Above, we passed the <code>df_xyz</code> data frame to the <code>.x</code>.</p></li>
<li><p>The second argument to all of the <code>map</code> functions is the <code>.f</code> argument. You should pass the name of function, or functions, you want to apply iteratively to the object you passed to the <code>.x</code> argument. In the example above, we passed the mean function to the <code>.f</code> argument. Notice that we typed <code>mean</code> without the parentheses.</p></li>
<li><p>The third argument to all of the <code>map</code> functions is the <code>...</code> argument. In this case, the <code>...</code> argument is where we pass any additional arguments to the function we passed to the <code>.f</code> argument. For example, we passed the <code>mean</code> function to the <code>.f</code> argument above. If the data frame above had missing values, we could have passed <code>na.rm = TRUE</code> to the <code>mean()</code> function using the <code>...</code> argument. We saw a similar <a href="column-wise-operations-in-dplyr.html#the-across-function">example of this when we were learning about <code>across()</code></a>.</p></li>
</ul>
<p>As you can see, using the <code>map_dbl()</code> package requires far less code than the for loop did, which has at least two potential advantages. First, it’s less typing, which means less opportunity for typos. Second, many people in the R community feel as though this <em>functional</em> (i.e., use of a function) approach to iteration is much easier to read and understand than the traditional for loop approach.</p>
<p>Additionally, you may have also noticed that we were able to assign the returned results of <code>map_dbl(df_xyz, mean)</code> to an object in our global environment in the usual way (i.e., with the assignment arrow). This eliminates the need for creating a structure to hold our results ahead of time as we had to do with the for loop.</p>
<p>Finally, when we use <code>map_dbl()</code> there isn’t a leftover index variable (i.e., <code>i</code>) floating around our global environment the way there was when we were writing for loops.</p>
<p>For those reasons, and possibly others, it’s been my observation that the majority of R users prefer the functional approach to iteration – either <code>purrr</code> or the <code>apply</code> functions – over using for loops in most situations.</p>
<p>However, my first experiences with programming were not with programming R. In fact, R was the third or fourth programming language I learned. And, all the others I had learned before R relied much more heavily on for loops. Perhaps for this reason, I tend to first think in terms of a for loop and then mentally convert the for loop to a <code>map</code> function before writing my code. Perhaps that is true for some of you reading this chapter as well. Therefore, the next section is going to compare and contrast the <em>basic</em> for loop with the <code>map</code> functions. You may find this section instructive or interesting even if you aren’t someone who first learned iteration using for loops.</p>
<div id="comparing-for-loops-and-the-map-functions" class="section level2 hasAnchor" number="37.1">
<h2><span class="header-section-number">37.1</span> Comparing for loops and the map functions<a href="using-the-purrr-package.html#comparing-for-loops-and-the-map-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="img/07_part_repeated_operations/05_purrr/compare.png" /><!-- --></p>
<p>In this section, we will compare for loops and the <code>purrr::map</code> functions using the example from the beginning of the chapter.</p>
<p><img src="img/07_part_repeated_operations/05_purrr/compare_for_map.png" /><!-- --></p>
<p>It’s probably obvious to you at this point, but I’ll go ahead and say it anyway. When using <code>purrr::map</code> instead of a for loop, we will be using one of the <code>map</code> functions instead of the <code>for()</code> function.</p>
<p><img src="img/07_part_repeated_operations/05_purrr/compare_assign.png" /><!-- --></p>
<p>Next, as previously discussed above, we are able to assign the returned results of <code>map_dbl(df_xyz, mean)</code> to an object in our global environment in the usual way (i.e., with the assignment arrow). This eliminates the need for creating a structure to hold our results ahead of time as we had to do with the for loop. It also eliminates the need to write code that explicitly updates the returned results structure at each iteration (i.e., <code>xyz_means[[i]]</code>) as we had to do with the for loop.</p>
<p>However, one nice byproduct of creating the structure to hold our returned results ahead of time was that doing so made it obvious what form and type we expected our results to take.</p>
<p><img src="img/07_part_repeated_operations/05_purrr/compare_type1.png" /><!-- --></p>
<p>In the <code>xyz_means</code> example above, it’s obvious that we expected our returned results to be a vector of numbers because the structure we created to contain our results was a vector of type double.</p>
<p><img src="img/07_part_repeated_operations/05_purrr/compare_type2.png" /><!-- --></p>
<p>When using the <code>purrr::map</code> functions, which <code>map</code> function we choose will serve the same purpose. In the example above, we used <code>map_dbl()</code>, which implied that we expected our results to be a vector of type double. In fact, it not only implied that our results <em>should</em> be a vector of type double, but it <em>guaranteed</em> that our results <em>would</em> be a vector of type double (or we would get an error). In this sense, the <code>map</code> functions are much safer to use than for loops – we don’t get unexpected results.</p>
<p>As a silly example, let’s say that we want to extract the number of letters in each name contained in a vector of names. We’ll start by creating a vector that contains three random names:</p>
<div class="sourceCode" id="cb1566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1566-1"><a href="using-the-purrr-package.html#cb1566-1" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Avril&quot;</span>, <span class="st">&quot;Joe&quot;</span>, <span class="st">&quot;Whitney&quot;</span>)</span></code></pre></div>
<p>Next, let’s create a structure to contain our results:</p>
<div class="sourceCode" id="cb1567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1567-1"><a href="using-the-purrr-package.html#cb1567-1" tabindex="-1"></a>n_letters <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="fu">length</span>(names)) <span class="co"># Expecting double</span></span></code></pre></div>
<p>The code above (i.e., <code>vector("double", length(names))</code>) implies that we expect our results to be type double, which make sense if we expect our results to be the number of letters in some names.</p>
<p>Finally, let’s write our for loop:</p>
<div class="sourceCode" id="cb1568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1568-1"><a href="using-the-purrr-package.html#cb1568-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(names)) {</span>
<span id="cb1568-2"><a href="using-the-purrr-package.html#cb1568-2" tabindex="-1"></a>  n_letters[[i]] <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(names[[i]], <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w&quot;</span>) <span class="co"># Returns character</span></span>
<span id="cb1568-3"><a href="using-the-purrr-package.html#cb1568-3" tabindex="-1"></a>}</span>
<span id="cb1568-4"><a href="using-the-purrr-package.html#cb1568-4" tabindex="-1"></a></span>
<span id="cb1568-5"><a href="using-the-purrr-package.html#cb1568-5" tabindex="-1"></a>n_letters</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;J&quot; &quot;W&quot;</code></pre>
<p>Uh, oh! Those “counts” are letters! What happened? Well, apparently we thought that <code>stringr::str_extract(names[[i]], "\\w")</code> would return the count of letters in each name. In actuality, it returns the first letter in each name.</p>
<p>As I said before, this is a silly example. In this case, it’s easy to see and fix our mistake. However, it could be very difficult to debug this problem if the code were buried in a long script or inside of other functions.</p>
<p>Now, let’s see what happens when we use <code>purrr</code>. We still start with the names:</p>
<div class="sourceCode" id="cb1570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1570-1"><a href="using-the-purrr-package.html#cb1570-1" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Avril&quot;</span>, <span class="st">&quot;Joe&quot;</span>, <span class="st">&quot;Whitney&quot;</span>)</span></code></pre></div>
<p>We also still imply our expectations that the returned result should be a numeric vector. However, this time we do so by using the <code>map_dbl</code> function:</p>
<div class="sourceCode" id="cb1571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1571-1"><a href="using-the-purrr-package.html#cb1571-1" tabindex="-1"></a>n_letters <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb1571-2"><a href="using-the-purrr-package.html#cb1571-2" tabindex="-1"></a>  <span class="at">.x =</span> names, </span>
<span id="cb1571-3"><a href="using-the-purrr-package.html#cb1571-3" tabindex="-1"></a>  <span class="at">.f =</span> stringr<span class="sc">::</span>str_extract, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w{1}&quot;</span></span>
<span id="cb1571-4"><a href="using-the-purrr-package.html#cb1571-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error in `map_dbl()`:
## ℹ In index: 1.
## Caused by error:
## ! Can&#39;t coerce from a string to a double.</code></pre>
<p>But, this time, we don’t get an unexpected result. This time, we get an error. This may seem like a pain if you are new’ish to programming. But, believe me when I say that you would much rather get an error that you can go fix than an incorrect result that you are totally unaware of!</p>
<p>While we are discussing return types, let’s go ahead and introduce some of the other <code>map</code> functions. They are:</p>
<ul>
<li><p><code>map_dbl()</code>, which we’ve already seen. The <code>map_dbl()</code> function always returns a numeric vector or an error.</p></li>
<li><p><code>map_int()</code>, which always returns an integer vector or an error.</p></li>
<li><p><code>map_lgl()</code>, which always returns a logical vector or an error.</p></li>
<li><p><code>map_chr()</code>, which always returns a character vector or an error.</p></li>
<li><p><code>map_dfr()</code>, which always returns a data frame created by row-binding results or an error.</p></li>
<li><p><code>map_dfc()</code>, which always returns a data frame created by column-binding results or an error.</p></li>
<li><p><code>map()</code>, which is the most generic, and always returns a list (or an error). We’ve haven’t discussed lists much in this book, but whenever something won’t fit into any other kind of object, it will fit into a list.</p></li>
<li><p><code>walk()</code>, which is the only <code>map</code> function without a <code>map</code> name. We will use <code>walk()</code> when we are more interested in the “side-effects” of the function passed to <code>.f</code> than its return value. What in the world does that mean? It means that the only thing <code>walk()</code> “returns” is exactly what was passed to its <code>.x</code> argument. No matter what you pass to the <code>.f</code> argument, the object passed to <code>.x</code> will be returned by <code>walk()</code> unmodified. Your next question might be, “then what’s the point? How could that ever be useful?” Typically, <code>walk()</code> will only be useful to us for plotting (e.g., where you are interested in viewing the plots, but not saving them as an object) and/or data transfer (we will see an example of this below).</p></li>
</ul>
<p><img src="img/07_part_repeated_operations/05_purrr/compare_object.png" /><!-- --></p>
<p>Next, the object we pass to the <code>.x</code> function of the <code>map</code> function replaces the entire <code>i in seq_along(object)</code> pattern that is passed to the for loop. Again, if the object passed to the <code>.x</code> argument is a vector, then <code>map</code> will apply the function passed to the <code>.f</code> argument to each element of the vector. If the object passed to the <code>.x</code> argument is a data frame, then <code>map</code> will apply the function passed to the <code>.f</code> argument to each column of the data frame.</p>
<p><img src="img/07_part_repeated_operations/05_purrr/compare_function.png" /><!-- --></p>
<p>Finally, the function passed to the <code>.f</code> argument can replace the rest of the “stuff” going on in the for loop body. We can pass a single function (e.g., mean) to the <code>.f</code> argument as we did above. However, we can also pass anonymous functions to the <code>.f</code> argument. We pass anonymous functions to the <code>.f</code> function in basically the exact same way passed anonymous functions to the <code>.fns</code> argument of the <code>across()</code> function in the <a href="column-wise-operations-in-dplyr.html#column-wise-operations-in-dplyr">chapter on column-wise operations</a>. And, yes, we can also write our anonymous functions using purrr-style lambdas. In fact, the purrr-style lambda syntax is called the purrr-style lambda syntax because it was first created for the <code>purrr</code> package and later adopted by <code>dplyr::across()</code>. I bet that name makes a lot more sense than it did a couple of chapters ago!</p>
<p>That pretty much covers the basics of using the <code>purrr::map</code> functions. If you’ve been reading this book in sequence, there won’t really be any conceptually new material in this chapter. We’re basically going to do the same things we’ve been doing for the last couple of chapters. We’ll just be using a slightly different (and perhaps preferable) syntax. If you haven’t been reading the book in sequence, you might want to read the chapters on <a href="writing-functions.html#writing-functions">writing functions</a>, <a href="column-wise-operations-in-dplyr.html#column-wise-operations-in-dplyr">column-wise operations</a>, and <a href="writing-for-loops.html#writing-for-loops">writing for loops</a> to get the most of the examples below.</p>
</div>
<div id="using-purrr-for-data-transfer" class="section level2 hasAnchor" number="37.2">
<h2><span class="header-section-number">37.2</span> Using purrr for data transfer<a href="using-the-purrr-package.html#using-purrr-for-data-transfer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-1-importing-multiple-sheets-from-an-excel-workbook" class="section level3 hasAnchor" number="37.2.1">
<h3><span class="header-section-number">37.2.1</span> Example 1: Importing multiple sheets from an Excel workbook<a href="using-the-purrr-package.html#example-1-importing-multiple-sheets-from-an-excel-workbook" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the <a href="writing-functions.html#writing-functions">chapter on writing functions</a> we used a for loop to help us import data from an Excel workbook that was stored across multiple sheets. We will once again go through this example using the <code>purrr</code> approach.</p>
<p>The simulated data contains some demographic information about three different cities: Houston, Atlanta, and Charlotte. In this scenario, we need to import each sheet, clean the data, and combine them into a single data frame in order to complete our analysis. First, we will load the <code>readxl</code> package:</p>
<div class="sourceCode" id="cb1573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1573-1"><a href="using-the-purrr-package.html#cb1573-1" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
<p><a href="https://github.com/brad-cannell/r4epi/blob/master/data/city_ses.xlsx">You may click here to download this file to your computer.</a></p>
<p>Then, we may import each sheet like this:</p>
<!-- No need to cache because eval=FALSE -->
<div class="sourceCode" id="cb1574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1574-1"><a href="using-the-purrr-package.html#cb1574-1" tabindex="-1"></a>houston <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1574-2"><a href="using-the-purrr-package.html#cb1574-2" tabindex="-1"></a>  <span class="st">&quot;data/city_ses.xlsx&quot;</span>,</span>
<span id="cb1574-3"><a href="using-the-purrr-package.html#cb1574-3" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">&quot;Houston&quot;</span></span>
<span id="cb1574-4"><a href="using-the-purrr-package.html#cb1574-4" tabindex="-1"></a>)</span>
<span id="cb1574-5"><a href="using-the-purrr-package.html#cb1574-5" tabindex="-1"></a></span>
<span id="cb1574-6"><a href="using-the-purrr-package.html#cb1574-6" tabindex="-1"></a>atlanta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1574-7"><a href="using-the-purrr-package.html#cb1574-7" tabindex="-1"></a>  <span class="st">&quot;data/city_ses.xlsx&quot;</span>,</span>
<span id="cb1574-8"><a href="using-the-purrr-package.html#cb1574-8" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">&quot;Atlanta&quot;</span></span>
<span id="cb1574-9"><a href="using-the-purrr-package.html#cb1574-9" tabindex="-1"></a>)</span>
<span id="cb1574-10"><a href="using-the-purrr-package.html#cb1574-10" tabindex="-1"></a></span>
<span id="cb1574-11"><a href="using-the-purrr-package.html#cb1574-11" tabindex="-1"></a>charlotte <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1574-12"><a href="using-the-purrr-package.html#cb1574-12" tabindex="-1"></a>  <span class="st">&quot;data/city_ses.xlsx&quot;</span>,</span>
<span id="cb1574-13"><a href="using-the-purrr-package.html#cb1574-13" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">&quot;Charlotte&quot;</span></span>
<span id="cb1574-14"><a href="using-the-purrr-package.html#cb1574-14" tabindex="-1"></a>)</span></code></pre></div>
<p>🚩In the code chunks above, we have essentially the same code copied more than twice. That’s a red flag that we should be thinking about removing unnecessary repetition from our code. So, our next step was to write a function to remove some of the unnecessary repetition:</p>
<!-- No need to cache because eval=FALSE -->
<div class="sourceCode" id="cb1575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1575-1"><a href="using-the-purrr-package.html#cb1575-1" tabindex="-1"></a>import_cities <span class="ot">&lt;-</span> <span class="cf">function</span>(sheet) {</span>
<span id="cb1575-2"><a href="using-the-purrr-package.html#cb1575-2" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1575-3"><a href="using-the-purrr-package.html#cb1575-3" tabindex="-1"></a>    <span class="st">&quot;data/city_ses.xlsx&quot;</span>,</span>
<span id="cb1575-4"><a href="using-the-purrr-package.html#cb1575-4" tabindex="-1"></a>    <span class="at">sheet =</span> sheet</span>
<span id="cb1575-5"><a href="using-the-purrr-package.html#cb1575-5" tabindex="-1"></a>  )</span>
<span id="cb1575-6"><a href="using-the-purrr-package.html#cb1575-6" tabindex="-1"></a>}</span>
<span id="cb1575-7"><a href="using-the-purrr-package.html#cb1575-7" tabindex="-1"></a></span>
<span id="cb1575-8"><a href="using-the-purrr-package.html#cb1575-8" tabindex="-1"></a>houston   <span class="ot">&lt;-</span> <span class="fu">import_cities</span>(<span class="st">&quot;Houston&quot;</span>)</span>
<span id="cb1575-9"><a href="using-the-purrr-package.html#cb1575-9" tabindex="-1"></a>atlanta   <span class="ot">&lt;-</span> <span class="fu">import_cities</span>(<span class="st">&quot;Atlanta&quot;</span>)</span>
<span id="cb1575-10"><a href="using-the-purrr-package.html#cb1575-10" tabindex="-1"></a>charlotte <span class="ot">&lt;-</span> <span class="fu">import_cities</span>(<span class="st">&quot;Charlotte&quot;</span>)</span></code></pre></div>
<p>🚩However, that approach still has some repetition. So, we next learned how to use a for loop as an alternative approach:</p>
<!-- No need to cache because eval=FALSE -->
<div class="sourceCode" id="cb1576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1576-1"><a href="using-the-purrr-package.html#cb1576-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;data/city_ses.xlsx&quot;</span></span>
<span id="cb1576-2"><a href="using-the-purrr-package.html#cb1576-2" tabindex="-1"></a>sheets <span class="ot">&lt;-</span> <span class="fu">excel_sheets</span>(path)</span>
<span id="cb1576-3"><a href="using-the-purrr-package.html#cb1576-3" tabindex="-1"></a></span>
<span id="cb1576-4"><a href="using-the-purrr-package.html#cb1576-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(sheets)) {</span>
<span id="cb1576-5"><a href="using-the-purrr-package.html#cb1576-5" tabindex="-1"></a>  new_nm <span class="ot">&lt;-</span> <span class="fu">tolower</span>(sheets[[i]])</span>
<span id="cb1576-6"><a href="using-the-purrr-package.html#cb1576-6" tabindex="-1"></a>  <span class="fu">assign</span>(new_nm, <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> sheets[[i]]))</span>
<span id="cb1576-7"><a href="using-the-purrr-package.html#cb1576-7" tabindex="-1"></a>}</span></code></pre></div>
<p>That works just fine! However, we could alternatively use <code>purrr::walk()</code> instead like this:</p>
<!-- No need to cache because eval=FALSE -->
<div class="sourceCode" id="cb1577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1577-1"><a href="using-the-purrr-package.html#cb1577-1" tabindex="-1"></a><span class="co"># Save the file path to an object so we don&#39;t have to type it repeatedly </span></span>
<span id="cb1577-2"><a href="using-the-purrr-package.html#cb1577-2" tabindex="-1"></a><span class="co"># or hard-code it in.</span></span>
<span id="cb1577-3"><a href="using-the-purrr-package.html#cb1577-3" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;data/city_ses.xlsx&quot;</span></span>
<span id="cb1577-4"><a href="using-the-purrr-package.html#cb1577-4" tabindex="-1"></a>  </span>
<span id="cb1577-5"><a href="using-the-purrr-package.html#cb1577-5" tabindex="-1"></a><span class="fu">walk</span>(</span>
<span id="cb1577-6"><a href="using-the-purrr-package.html#cb1577-6" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">excel_sheets</span>(path),</span>
<span id="cb1577-7"><a href="using-the-purrr-package.html#cb1577-7" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb1577-8"><a href="using-the-purrr-package.html#cb1577-8" tabindex="-1"></a>    new_nm <span class="ot">&lt;-</span> <span class="fu">tolower</span>(x)</span>
<span id="cb1577-9"><a href="using-the-purrr-package.html#cb1577-9" tabindex="-1"></a>    <span class="fu">assign</span>(new_nm, <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> x), <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb1577-10"><a href="using-the-purrr-package.html#cb1577-10" tabindex="-1"></a>  }</span>
<span id="cb1577-11"><a href="using-the-purrr-package.html#cb1577-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1578-1"><a href="using-the-purrr-package.html#cb1578-1" tabindex="-1"></a>houston</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex   ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 001      13 F            88
## 2 003      13 F            78
## 3 007      14 M            83
## 4 014      12 F            76
## 5 036      13 M            84</code></pre>
<div class="sourceCode" id="cb1580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1580-1"><a href="using-the-purrr-package.html#cb1580-1" tabindex="-1"></a>atlanta</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   id      age gender ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 002      14 M             64
## 2 009      15 M             35
## 3 012      13 F             70
## 4 013      13 F             66
## 5 022      12 F             59</code></pre>
<div class="sourceCode" id="cb1582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1582-1"><a href="using-the-purrr-package.html#cb1582-1" tabindex="-1"></a>charlotte</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex     ses
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 004      13 F        84
## 2 011      14 M        66
## 3 018      12 M        92
## 4 023      12 M        89
## 5 030      13 F        83</code></pre>
<p>👆<strong>Here’s what we did above:</strong></p>
<ul>
<li><p>We used the <code>walk()</code> function from the <code>purrr</code> package to import every sheet from an Excel workbook.</p></li>
<li><p>First, we saved the path to the Excel workbook to a separate object. We didn’t have to do this. However, doing so prevented us from having to type out the full file path repeatedly in the rest of our code. Additionally, if the file path ever changed, we would only have to update it in one place.</p></li>
<li><p>Second, we passed the return value of the <code>excel_sheets()</code> function, which is a character vector containing each sheet name, to the <code>.x</code> argument of the <code>walk()</code> function. We didn’t have to do this. We could have typed each sheet name manually. However, there shouldn’t be any accidental typos if we use the <code>excel_sheets()</code> function, and we don’t have to make any changes to our code if more sheets are added to the Workbook in the future.</p></li>
<li><p>Third, we passed an anonymous function to the <code>walk()</code>’s <code>.f</code> argument. Inside the anonymous function, we assigned each data frame created by the <code>read_excel()</code> function to our global environment using the <code>assign()</code> function. Notice that because we are using the <code>assign()</code> <em>inside</em> of another function, we have to explicitly tell the <code>assign()</code> function to assign the data frames being imported to the global environment using <code>envir = .GlobalEnv</code>. Without getting too technical, keep in mind that functions create their own little enclosed environments (<a href="writing-functions.html#lexical-scoping-and-functions">see a discussion here</a>), which makes the <code>envir = .GlobalEnv</code> part necessary.</p></li>
</ul>
<p>Additionally, you may have some questions swirling around your head right now about the <code>walk()</code> function itself. In particular, I’m imagining that you are wondering why we used <code>walk()</code> instead of <code>map()</code> and why we didn’t assign the return value of <code>walk()</code> to an object. I’ll answer both questions next.</p>
</div>
<div id="why-walk-instead-of-map" class="section level3 hasAnchor" number="37.2.2">
<h3><span class="header-section-number">37.2.2</span> Why walk instead of map?<a href="using-the-purrr-package.html#why-walk-instead-of-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The short answer is that <code>map</code> functions return <em>one</em> thing (i.e., a vector, list, or data frame). In this situation, we wanted to “return” <em>three</em> things (i.e., the <code>houston</code> data frame, the <code>atlanta</code> data frame, and the <code>charlotte</code> data frame).</p>
<p>Technically, we could have used the <code>map()</code> function to return a list of data frames like this:</p>
<div class="sourceCode" id="cb1584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1584-1"><a href="using-the-purrr-package.html#cb1584-1" tabindex="-1"></a>list_of_df <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb1584-2"><a href="using-the-purrr-package.html#cb1584-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">excel_sheets</span>(path),</span>
<span id="cb1584-3"><a href="using-the-purrr-package.html#cb1584-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> .x)</span>
<span id="cb1584-4"><a href="using-the-purrr-package.html#cb1584-4" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1585-1"><a href="using-the-purrr-package.html#cb1585-1" tabindex="-1"></a><span class="fu">str</span>(list_of_df)</span></code></pre></div>
<pre><code>## List of 3
##  $ : tibble [5 × 4] (S3: tbl_df/tbl/data.frame)
##   ..$ pid      : chr [1:5] &quot;001&quot; &quot;003&quot; &quot;007&quot; &quot;014&quot; ...
##   ..$ age      : num [1:5] 13 13 14 12 13
##   ..$ sex      : chr [1:5] &quot;F&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; ...
##   ..$ ses_score: num [1:5] 88 78 83 76 84
##  $ : tibble [5 × 4] (S3: tbl_df/tbl/data.frame)
##   ..$ id       : chr [1:5] &quot;002&quot; &quot;009&quot; &quot;012&quot; &quot;013&quot; ...
##   ..$ age      : num [1:5] 14 15 13 13 12
##   ..$ gender   : chr [1:5] &quot;M&quot; &quot;M&quot; &quot;F&quot; &quot;F&quot; ...
##   ..$ ses_score: num [1:5] 64 35 70 66 59
##  $ : tibble [5 × 4] (S3: tbl_df/tbl/data.frame)
##   ..$ pid: chr [1:5] &quot;004&quot; &quot;011&quot; &quot;018&quot; &quot;023&quot; ...
##   ..$ age: num [1:5] 13 14 12 12 13
##   ..$ sex: chr [1:5] &quot;F&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; ...
##   ..$ ses: num [1:5] 84 66 92 89 83</code></pre>
<p>From there, we could extract and modify each data frame from the list like this:</p>
<div class="sourceCode" id="cb1587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1587-1"><a href="using-the-purrr-package.html#cb1587-1" tabindex="-1"></a>houston <span class="ot">&lt;-</span> list_of_df[[<span class="dv">1</span>]]</span>
<span id="cb1587-2"><a href="using-the-purrr-package.html#cb1587-2" tabindex="-1"></a>houston</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex   ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 001      13 F            88
## 2 003      13 F            78
## 3 007      14 M            83
## 4 014      12 F            76
## 5 036      13 M            84</code></pre>
<div class="sourceCode" id="cb1589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1589-1"><a href="using-the-purrr-package.html#cb1589-1" tabindex="-1"></a>atlanta <span class="ot">&lt;-</span> list_of_df[[<span class="dv">2</span>]]</span>
<span id="cb1589-2"><a href="using-the-purrr-package.html#cb1589-2" tabindex="-1"></a>atlanta</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   id      age gender ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 002      14 M             64
## 2 009      15 M             35
## 3 012      13 F             70
## 4 013      13 F             66
## 5 022      12 F             59</code></pre>
<div class="sourceCode" id="cb1591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1591-1"><a href="using-the-purrr-package.html#cb1591-1" tabindex="-1"></a>charlotte <span class="ot">&lt;-</span> list_of_df[[<span class="dv">2</span>]]</span>
<span id="cb1591-2"><a href="using-the-purrr-package.html#cb1591-2" tabindex="-1"></a>charlotte</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   id      age gender ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 002      14 M             64
## 2 009      15 M             35
## 3 012      13 F             70
## 4 013      13 F             66
## 5 022      12 F             59</code></pre>
<p>Of course, now we have a bunch of repetition again! Alternatively, we could have also used the <code>map_dfr()</code>, which always returns a data frame created by row-binding results or an error. You can think of <code>map_dfr()</code> as taking the three data frames above and passing them to the <code>bind_rows()</code> function and returning that result:</p>
<div class="sourceCode" id="cb1593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1593-1"><a href="using-the-purrr-package.html#cb1593-1" tabindex="-1"></a><span class="co"># Passing list_of_df to bind_rows()</span></span>
<span id="cb1593-2"><a href="using-the-purrr-package.html#cb1593-2" tabindex="-1"></a><span class="fu">bind_rows</span>(list_of_df)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 7
##    pid     age sex   ses_score id    gender   ses
##    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1 001      13 F            88 &lt;NA&gt;  &lt;NA&gt;      NA
##  2 003      13 F            78 &lt;NA&gt;  &lt;NA&gt;      NA
##  3 007      14 M            83 &lt;NA&gt;  &lt;NA&gt;      NA
##  4 014      12 F            76 &lt;NA&gt;  &lt;NA&gt;      NA
##  5 036      13 M            84 &lt;NA&gt;  &lt;NA&gt;      NA
##  6 &lt;NA&gt;     14 &lt;NA&gt;         64 002   M         NA
##  7 &lt;NA&gt;     15 &lt;NA&gt;         35 009   M         NA
##  8 &lt;NA&gt;     13 &lt;NA&gt;         70 012   F         NA
##  9 &lt;NA&gt;     13 &lt;NA&gt;         66 013   F         NA
## 10 &lt;NA&gt;     12 &lt;NA&gt;         59 022   F         NA
## 11 004      13 F            NA &lt;NA&gt;  &lt;NA&gt;      84
## 12 011      14 M            NA &lt;NA&gt;  &lt;NA&gt;      66
## 13 018      12 M            NA &lt;NA&gt;  &lt;NA&gt;      92
## 14 023      12 M            NA &lt;NA&gt;  &lt;NA&gt;      89
## 15 030      13 F            NA &lt;NA&gt;  &lt;NA&gt;      83</code></pre>
<div class="sourceCode" id="cb1595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1595-1"><a href="using-the-purrr-package.html#cb1595-1" tabindex="-1"></a><span class="co"># Using map_dfr() to directly produce the same result</span></span>
<span id="cb1595-2"><a href="using-the-purrr-package.html#cb1595-2" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb1595-3"><a href="using-the-purrr-package.html#cb1595-3" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">excel_sheets</span>(path),</span>
<span id="cb1595-4"><a href="using-the-purrr-package.html#cb1595-4" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> .x)</span>
<span id="cb1595-5"><a href="using-the-purrr-package.html#cb1595-5" tabindex="-1"></a>)</span>
<span id="cb1595-6"><a href="using-the-purrr-package.html#cb1595-6" tabindex="-1"></a></span>
<span id="cb1595-7"><a href="using-the-purrr-package.html#cb1595-7" tabindex="-1"></a>cities</span></code></pre></div>
<pre><code>## # A tibble: 15 × 7
##    pid     age sex   ses_score id    gender   ses
##    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1 001      13 F            88 &lt;NA&gt;  &lt;NA&gt;      NA
##  2 003      13 F            78 &lt;NA&gt;  &lt;NA&gt;      NA
##  3 007      14 M            83 &lt;NA&gt;  &lt;NA&gt;      NA
##  4 014      12 F            76 &lt;NA&gt;  &lt;NA&gt;      NA
##  5 036      13 M            84 &lt;NA&gt;  &lt;NA&gt;      NA
##  6 &lt;NA&gt;     14 &lt;NA&gt;         64 002   M         NA
##  7 &lt;NA&gt;     15 &lt;NA&gt;         35 009   M         NA
##  8 &lt;NA&gt;     13 &lt;NA&gt;         70 012   F         NA
##  9 &lt;NA&gt;     13 &lt;NA&gt;         66 013   F         NA
## 10 &lt;NA&gt;     12 &lt;NA&gt;         59 022   F         NA
## 11 004      13 F            NA &lt;NA&gt;  &lt;NA&gt;      84
## 12 011      14 M            NA &lt;NA&gt;  &lt;NA&gt;      66
## 13 018      12 M            NA &lt;NA&gt;  &lt;NA&gt;      92
## 14 023      12 M            NA &lt;NA&gt;  &lt;NA&gt;      89
## 15 030      13 F            NA &lt;NA&gt;  &lt;NA&gt;      83</code></pre>
<p>There would be absolutely nothing wrong with taking this approach and then cleaning up the combined data you see above. However, my preference in this case was to import each sheet as a separate data frame, clean up each separate data frame, and then combine myself. If your preference is to use <code>map_dfr()</code> instead, then you definitely should.</p>
</div>
<div id="why-we-didnt-assign-the-return-value-of-walk-to-an-object" class="section level3 hasAnchor" number="37.2.3">
<h3><span class="header-section-number">37.2.3</span> why we didn’t assign the return value of <code>walk()</code> to an object?<a href="using-the-purrr-package.html#why-we-didnt-assign-the-return-value-of-walk-to-an-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we discussed above, the only thing <code>walk()</code> “returns” is exactly what was passed to its <code>.x</code> argument. No matter what you pass to the <code>.f</code> argument, the object passed to <code>.x</code> will be returned by <code>walk()</code> unmodified. In this case, that would just be the sheet names:</p>
<div class="sourceCode" id="cb1597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1597-1"><a href="using-the-purrr-package.html#cb1597-1" tabindex="-1"></a>returned_by_walk <span class="ot">&lt;-</span> <span class="fu">walk</span>(</span>
<span id="cb1597-2"><a href="using-the-purrr-package.html#cb1597-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">excel_sheets</span>(path),</span>
<span id="cb1597-3"><a href="using-the-purrr-package.html#cb1597-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb1597-4"><a href="using-the-purrr-package.html#cb1597-4" tabindex="-1"></a>    new_nm <span class="ot">&lt;-</span> <span class="fu">tolower</span>(x)</span>
<span id="cb1597-5"><a href="using-the-purrr-package.html#cb1597-5" tabindex="-1"></a>    <span class="fu">assign</span>(new_nm, <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> x), <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb1597-6"><a href="using-the-purrr-package.html#cb1597-6" tabindex="-1"></a>  }</span>
<span id="cb1597-7"><a href="using-the-purrr-package.html#cb1597-7" tabindex="-1"></a>)</span>
<span id="cb1597-8"><a href="using-the-purrr-package.html#cb1597-8" tabindex="-1"></a></span>
<span id="cb1597-9"><a href="using-the-purrr-package.html#cb1597-9" tabindex="-1"></a>returned_by_walk</span></code></pre></div>
<pre><code>## [1] &quot;Houston&quot;   &quot;Atlanta&quot;   &quot;Charlotte&quot;</code></pre>
<p>Don’t be confused, the data frames are still being imported and assigned to the global environment via the anonymous function we passed to <code>.f</code> above. But, but those data frames aren’t the values <em>returned by</em> <code>walk()</code> – They are a <em>side-effect</em> of the operations taking place inside of <code>walk()</code>.</p>
<pre><code>## Warning in rm(returned_by_walk, atlanta, charlotte, houston): object &#39;atlanta&#39; not found</code></pre>
<pre><code>## Warning in rm(returned_by_walk, atlanta, charlotte, houston): object &#39;charlotte&#39; not found</code></pre>
<pre><code>## Warning in rm(returned_by_walk, atlanta, charlotte, houston): object &#39;houston&#39; not found</code></pre>
<p>Finally, we could make our original <code>walk()</code> code slightly more concise by using the purrr-style lambda syntax to write our anonymous function like this:</p>
<div class="sourceCode" id="cb1602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1602-1"><a href="using-the-purrr-package.html#cb1602-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;data/city_ses.xlsx&quot;</span></span>
<span id="cb1602-2"><a href="using-the-purrr-package.html#cb1602-2" tabindex="-1"></a>  </span>
<span id="cb1602-3"><a href="using-the-purrr-package.html#cb1602-3" tabindex="-1"></a><span class="fu">walk</span>(</span>
<span id="cb1602-4"><a href="using-the-purrr-package.html#cb1602-4" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">excel_sheets</span>(path),</span>
<span id="cb1602-5"><a href="using-the-purrr-package.html#cb1602-5" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">assign</span>(<span class="fu">tolower</span>(.), <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> .), <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb1602-6"><a href="using-the-purrr-package.html#cb1602-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1603-1"><a href="using-the-purrr-package.html#cb1603-1" tabindex="-1"></a>houston</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex   ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 001      13 F            88
## 2 003      13 F            78
## 3 007      14 M            83
## 4 014      12 F            76
## 5 036      13 M            84</code></pre>
<div class="sourceCode" id="cb1605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1605-1"><a href="using-the-purrr-package.html#cb1605-1" tabindex="-1"></a>atlanta</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   id      age gender ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 002      14 M             64
## 2 009      15 M             35
## 3 012      13 F             70
## 4 013      13 F             66
## 5 022      12 F             59</code></pre>
<div class="sourceCode" id="cb1607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1607-1"><a href="using-the-purrr-package.html#cb1607-1" tabindex="-1"></a>charlotte</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex     ses
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 004      13 F        84
## 2 011      14 M        66
## 3 018      12 M        92
## 4 023      12 M        89
## 5 030      13 F        83</code></pre>
<pre><code>## Warning in rm(atlanta, charlotte, houston, path): object &#39;atlanta&#39; not found</code></pre>
<pre><code>## Warning in rm(atlanta, charlotte, houston, path): object &#39;charlotte&#39; not found</code></pre>
<pre><code>## Warning in rm(atlanta, charlotte, houston, path): object &#39;houston&#39; not found</code></pre>
</div>
</div>
<div id="using-purrr-for-data-management" class="section level2 hasAnchor" number="37.3">
<h2><span class="header-section-number">37.3</span> Using purrr for data management<a href="using-the-purrr-package.html#using-purrr-for-data-management" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-1-adding-na-at-multiple-positions" class="section level3 hasAnchor" number="37.3.1">
<h3><span class="header-section-number">37.3.1</span> Example 1: Adding NA at multiple positions<a href="using-the-purrr-package.html#example-1-adding-na-at-multiple-positions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll start this section with a relatively simple example using the same data we used to start the <a href="column-wise-operations-in-dplyr.html#column-wise-operations-in-dplyr">chapter on column-wise operations</a> and the <a href="writing-for-loops.html#writing-for-loops">chapter on writing for loops</a>.</p>
<div class="sourceCode" id="cb1612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1612-1"><a href="using-the-purrr-package.html#cb1612-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1612-2"><a href="using-the-purrr-package.html#cb1612-2" tabindex="-1"></a>df_xyz <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1612-3"><a href="using-the-purrr-package.html#cb1612-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb1612-4"><a href="using-the-purrr-package.html#cb1612-4" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb1612-5"><a href="using-the-purrr-package.html#cb1612-5" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb1612-6"><a href="using-the-purrr-package.html#cb1612-6" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1612-7"><a href="using-the-purrr-package.html#cb1612-7" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 -0.230   0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705  0.111 -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  -1.69 
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>In those chapters, we used the code below to add missing values to our data frame:</p>
<div class="sourceCode" id="cb1614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1614-1"><a href="using-the-purrr-package.html#cb1614-1" tabindex="-1"></a>df_xyz<span class="sc">$</span>x[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb1614-2"><a href="using-the-purrr-package.html#cb1614-2" tabindex="-1"></a>df_xyz<span class="sc">$</span>y[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb1614-3"><a href="using-the-purrr-package.html#cb1614-3" tabindex="-1"></a>df_xyz<span class="sc">$</span>z[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb1614-4"><a href="using-the-purrr-package.html#cb1614-4" tabindex="-1"></a>df_xyz</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 NA       0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705 NA     -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  NA    
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p><em>Dealing</em> with those missing values, rather than <em>adding</em> those missing values was the point of the previously mentioned examples. So, we ignored the unnecessary repetition in the code above. But, for all the reasons we’ve been discussing, we should strive to write more robust code. Imagine, for example, that you were adding missing data to hundreds or thousands of rows as part of a simulation study. Using the method above would become problematic pretty quickly.</p>
<p>In this case, I think it might be useful to start our solution with writing a function (<a href="writing-functions.html#writing-functions">click here to review function writing</a>). Let’s name our function <code>add_na_at()</code> because it helps us add an <code>NA</code> value to a vector at a position of our choosing. Logically, then, it follows that we will need to be able to pass our function a <em>vector</em> that we want to add the <code>NA</code> value to, and a <em>position</em> to add the <code>NA</code> value at. So, our first attempt might look something like this:</p>
<div class="sourceCode" id="cb1616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1616-1"><a href="using-the-purrr-package.html#cb1616-1" tabindex="-1"></a>add_na_at <span class="ot">&lt;-</span> <span class="cf">function</span>(vect, pos) {</span>
<span id="cb1616-2"><a href="using-the-purrr-package.html#cb1616-2" tabindex="-1"></a>  vect[[pos]] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1616-3"><a href="using-the-purrr-package.html#cb1616-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s test it out:</p>
<div class="sourceCode" id="cb1617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1617-1"><a href="using-the-purrr-package.html#cb1617-1" tabindex="-1"></a><span class="fu">add_na_at</span>(df_xyz<span class="sc">$</span>x, <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Is a single <code>NA</code> the result we wanted? Nope! If this result is surprising to you, please review the <a href="writing-functions.html#the-values-your-functions-return">section of the writing functions chapter on return values</a>. Briefly, the last line of our function body is the single value <code>df_xyz$x[[2]]</code>, which was set to be equal to <code>NA</code>. But, we don’t want our function to return just one position of the vector – we want it to return the entire vector. So, let’s reference the entire vector on the last line of the function body:</p>
<div class="sourceCode" id="cb1619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1619-1"><a href="using-the-purrr-package.html#cb1619-1" tabindex="-1"></a>add_na_at <span class="ot">&lt;-</span> <span class="cf">function</span>(vect, pos) {</span>
<span id="cb1619-2"><a href="using-the-purrr-package.html#cb1619-2" tabindex="-1"></a>  vect[[pos]] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1619-3"><a href="using-the-purrr-package.html#cb1619-3" tabindex="-1"></a>  vect</span>
<span id="cb1619-4"><a href="using-the-purrr-package.html#cb1619-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1620-1"><a href="using-the-purrr-package.html#cb1620-1" tabindex="-1"></a><span class="fu">add_na_at</span>(df_xyz<span class="sc">$</span>x, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##  [1] -0.56047565          NA  1.55870831  0.07050839  0.12928774  1.71506499  0.46091621 -1.26506123 -0.68685285 -0.44566197</code></pre>
<p>That’s better! Again, we know that data frame columns <em>are</em> vectors, so we can use our new function inside of mutate to add <code>NA</code> values to each column in our data frame at a position of our choosing:</p>
<div class="sourceCode" id="cb1622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1622-1"><a href="using-the-purrr-package.html#cb1622-1" tabindex="-1"></a>df_xyz <span class="sc">%&gt;%</span> </span>
<span id="cb1622-2"><a href="using-the-purrr-package.html#cb1622-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1622-3"><a href="using-the-purrr-package.html#cb1622-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">add_na_at</span>(x, <span class="dv">2</span>),</span>
<span id="cb1622-4"><a href="using-the-purrr-package.html#cb1622-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">add_na_at</span>(y, <span class="dv">4</span>),</span>
<span id="cb1622-5"><a href="using-the-purrr-package.html#cb1622-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">add_na_at</span>(z, <span class="dv">6</span>)</span>
<span id="cb1622-6"><a href="using-the-purrr-package.html#cb1622-6" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 NA       0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705 NA     -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  NA    
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>I can hear what you are saying now. “Sure, that’s the result we wanted, but we didn’t eliminate very much repetitive code.” You are not wrong. A case could be made that this code is easier to quickly glance at and understand, but it isn’t much less repetitive. That’s where <code>purrr</code> comes in. Let’s try using <code>purrr</code> to come up with a better solution now.</p>
<p>The first question we might ask ourselves is, “which <code>map</code> function should we choose?” Well, we know we want our end result to be a data frame, so it makes sense for us to choose either <code>map_dfr</code> or <code>map_dfc</code>. However, I personally find it useful to start with the plain <code>map()</code> function that returns a list as I begin to experiment with solving a problem using <code>purrr</code>. I think I do that because R can put almost anything into a list, and therefore, we will almost always get <em>something</em> returned to us (as opposed to an error) by <code>map()</code>. Further, the thing returned to us typically can provide us with some insight into what’s going on inside <code>.f</code>.</p>
<p>Next, we know that we want to iterate over every column of the <code>df_xyz</code> data frame. So, we can pass it to the <code>.x</code> argument.</p>
<p>We also know that we want each column to get passed to the <code>vect</code> argument of <code>add_na_at()</code> iteratively. So, we want to pass <code>add_na_at</code> (without parentheses) to the <code>.f</code> argument.</p>
<p>Finally, we can’t supply <code>add_na_at()</code> with just one argument – the vector – can we?</p>
<div class="sourceCode" id="cb1624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1624-1"><a href="using-the-purrr-package.html#cb1624-1" tabindex="-1"></a><span class="fu">add_na_at</span>(df_xyz<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>## Error in vect[[pos]] &lt;- NA: missing subscript</code></pre>
<p>No way! We have to give it position as well. Do you remember which argument allows us to pass any additional arguments to the function we passed to the <code>.f</code> argument?</p>
<p>The <code>...</code> argument is where we pass any additional arguments to the function we passed to the <code>.f</code> argument. But remember, we don’t actually type out <code>... =</code>. We simply type additional arguments, separated by commas, after the function name supplied to <code>.f</code>:</p>
<div class="sourceCode" id="cb1626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1626-1"><a href="using-the-purrr-package.html#cb1626-1" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb1626-2"><a href="using-the-purrr-package.html#cb1626-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1626-3"><a href="using-the-purrr-package.html#cb1626-3" tabindex="-1"></a>  <span class="at">.f =</span> add_na_at, <span class="dv">2</span></span>
<span id="cb1626-4"><a href="using-the-purrr-package.html#cb1626-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $x
##  [1] -0.56047565          NA  1.55870831  0.07050839  0.12928774  1.71506499  0.46091621 -1.26506123 -0.68685285 -0.44566197
## 
## $y
##  [1]  1.2240818         NA  0.4007715         NA -0.5558411  1.7869131  0.4978505 -1.9666172  0.7013559 -0.4727914
## 
## $z
##  [1] -1.0678237         NA -1.0260044 -0.7288912 -0.6250393         NA  0.8377870  0.1533731 -1.1381369  1.2538149</code></pre>
<p>Or alternatively, we can use the purrr-style lambda to pass our function to <code>.f</code>:</p>
<div class="sourceCode" id="cb1628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1628-1"><a href="using-the-purrr-package.html#cb1628-1" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb1628-2"><a href="using-the-purrr-package.html#cb1628-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1628-3"><a href="using-the-purrr-package.html#cb1628-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">add_na_at</span>(.x, <span class="dv">2</span>)</span>
<span id="cb1628-4"><a href="using-the-purrr-package.html#cb1628-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $x
##  [1] -0.56047565          NA  1.55870831  0.07050839  0.12928774  1.71506499  0.46091621 -1.26506123 -0.68685285 -0.44566197
## 
## $y
##  [1]  1.2240818         NA  0.4007715         NA -0.5558411  1.7869131  0.4978505 -1.9666172  0.7013559 -0.4727914
## 
## $z
##  [1] -1.0678237         NA -1.0260044 -0.7288912 -0.6250393         NA  0.8377870  0.1533731 -1.1381369  1.2538149</code></pre>
<p>Notice that we have to use the special <code>.x</code> symbol inside the function call where we would normally want to type the name of the column we want the function to operate on. We saw something similar before in the <a href="column-wise-operations-in-dplyr.html#column-wise-operations-in-dplyr">chapter on column-wise operations</a>.</p>
<p>Now, let’s discuss the result we are getting. The result you see above is a list, which is what <code>map()</code> will always return to us. Specifically, this is a list with three elements – <code>x</code>, <code>y</code>, and <code>z</code>. Each element of the list is a vector of numbers. Does this feel familiar? Does it seem sort of similar to a data frame? If so, good intuition! In R, a data frame <em>is</em> a list. It’s simply a special case of a list. It’s a special case because all vectors in the data frame must have the length, and because R knows to print each vector to the screen as a column. In fact, we can easily convert the list above to a data frame by passing it to the <code>as.data.frame()</code> function:</p>
<div class="sourceCode" id="cb1630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1630-1"><a href="using-the-purrr-package.html#cb1630-1" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb1630-2"><a href="using-the-purrr-package.html#cb1630-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1630-3"><a href="using-the-purrr-package.html#cb1630-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">add_na_at</span>(.x, <span class="dv">2</span>)</span>
<span id="cb1630-4"><a href="using-the-purrr-package.html#cb1630-4" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1630-5"><a href="using-the-purrr-package.html#cb1630-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code></pre></div>
<pre><code>##              x          y          z
## 1  -0.56047565  1.2240818 -1.0678237
## 2           NA         NA         NA
## 3   1.55870831  0.4007715 -1.0260044
## 4   0.07050839         NA -0.7288912
## 5   0.12928774 -0.5558411 -0.6250393
## 6   1.71506499  1.7869131         NA
## 7   0.46091621  0.4978505  0.8377870
## 8  -1.26506123 -1.9666172  0.1533731
## 9  -0.68685285  0.7013559 -1.1381369
## 10 -0.44566197 -0.4727914  1.2538149</code></pre>
<p>Alternatively, we could just use <code>map_dfc</code> as a shortcut instead:</p>
<div class="sourceCode" id="cb1632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1632-1"><a href="using-the-purrr-package.html#cb1632-1" tabindex="-1"></a><span class="fu">map_dfc</span>(</span>
<span id="cb1632-2"><a href="using-the-purrr-package.html#cb1632-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1632-3"><a href="using-the-purrr-package.html#cb1632-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">add_na_at</span>(.x, <span class="dv">2</span>)</span>
<span id="cb1632-4"><a href="using-the-purrr-package.html#cb1632-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 NA      NA     NA    
##  3  1.56    0.401 -1.03 
##  4  0.0705 NA     -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  NA    
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>Why <code>map_dfc</code> instead of <code>map_dfr</code>? Because we want to combine <code>x</code>, <code>y</code>, and <code>z</code> together as <em>columns</em>, not as rows.</p>
<p>Ok, so we almost have the solution we want. There’s just one problem. In the code above, the <code>NA</code> is always being put into the second position because we have <code>2</code> hard-coded into <code>add_na_at(.x, 2)</code>. We need a way to iterate over our columns <em>and</em> a set of numbers <em>simultaneously</em> in order to get the final result we want. Fortunately, that’s exactly what the <code>map2</code> variants (i.e., <code>map2_dbl()</code>, <code>map2_int()</code>, <code>map2_lgl()</code>, etc.) of each of the <code>map</code> functions allows us to do.</p>
<p>Instead of supplying map a single object to iterate over (i.e., <code>.x</code>) we can supply it with <em>two</em> objects to iterate over (i.e., <code>.x</code> and <code>.y</code>):</p>
<div class="sourceCode" id="cb1634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1634-1"><a href="using-the-purrr-package.html#cb1634-1" tabindex="-1"></a><span class="fu">map2_dfc</span>(</span>
<span id="cb1634-2"><a href="using-the-purrr-package.html#cb1634-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1634-3"><a href="using-the-purrr-package.html#cb1634-3" tabindex="-1"></a>  <span class="at">.y =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>),</span>
<span id="cb1634-4"><a href="using-the-purrr-package.html#cb1634-4" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">add_na_at</span>(.x, .y)</span>
<span id="cb1634-5"><a href="using-the-purrr-package.html#cb1634-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 NA       0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705 NA     -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  NA    
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>This can sometimes take a second to wrap your mind around. Here’s an illustration that may help:</p>
<p><img src="img/07_part_repeated_operations/05_purrr/iteration_1_1.png" /><!-- --></p>
<p>In the first iteration, <code>.x</code> took on the value of the first column in the <code>df_xyz</code> data frame (i.e., <code>x</code>) and <code>.y</code> took on the value of the first element in the numeric vector that we passed to the <code>.y</code> argument (i.e., <code>2</code>). Then, the <code>.x</code> and <code>.y</code> were replaced with <code>df_xyz$x</code> and <code>2</code> respectively in the function we passed to <code>.f</code>. The result of that iteration was a vector of numbers that was identical to <code>df_xyz$x</code> except that its second element was an <code>NA</code>.</p>
<p><img src="img/07_part_repeated_operations/05_purrr/iteration_1_2.png" /><!-- --></p>
<p>In the second iteration, <code>.x</code> took on the value of the second column in the <code>df_xyz</code> data frame (i.e., <code>y</code>) and <code>.y</code> took on the value of the second element in the numeric vector that we passed to the <code>.y</code> argument (i.e., <code>4</code>). Then, the <code>.x</code> and <code>.y</code> were replaced with <code>df_xyz$y</code> and <code>4</code> respectively in the function we passed to <code>.f</code>. The result of that iteration was a vector of numbers that was identical to <code>df_xyz$y</code> except that its fourth element was an <code>NA</code>.</p>
<p><img src="img/07_part_repeated_operations/05_purrr/iteration_1_3.png" /><!-- --></p>
<p>In the third iteration, <code>.x</code> took on the value of the third column in the <code>df_xyz</code> data frame (i.e., <code>z</code>) and <code>.y</code> took on the value of the third element in the numeric vector that we passed to the <code>.y</code> argument (i.e., <code>6</code>). Then, the <code>.x</code> and <code>.y</code> were replaced with <code>df_xyz$z</code> and <code>6</code> respectively in the function we passed to <code>.f</code>. The result of that iteration was a vector of numbers that was identical to <code>df_xyz$z</code> except that its sixth element was an <code>NA</code>.</p>
<p>Finally, <code>map2_dfc()</code> passed all of these vectors to <code>bind_cols()</code> (invisibly to us) and returned them as a data frame.</p>
<p>The code above gives us our entire solution. But, if we really were using this code in a simulation with hundreds or thousands of columns, we probably wouldn’t want to manually supply a vector of column positions to the <code>.y</code> argument. Instead, we could use the <code>sample()</code> function to supply random column positions to the <code>.y</code> argument like this:</p>
<div class="sourceCode" id="cb1636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1636-1"><a href="using-the-purrr-package.html#cb1636-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8142020</span>)</span>
<span id="cb1636-2"><a href="using-the-purrr-package.html#cb1636-2" tabindex="-1"></a></span>
<span id="cb1636-3"><a href="using-the-purrr-package.html#cb1636-3" tabindex="-1"></a><span class="fu">map2_dfc</span>(</span>
<span id="cb1636-4"><a href="using-the-purrr-package.html#cb1636-4" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1636-5"><a href="using-the-purrr-package.html#cb1636-5" tabindex="-1"></a>  <span class="at">.y =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">3</span>, <span class="cn">TRUE</span>),</span>
<span id="cb1636-6"><a href="using-the-purrr-package.html#cb1636-6" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">add_na_at</span>(.x, .y)</span>
<span id="cb1636-7"><a href="using-the-purrr-package.html#cb1636-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560  NA     -1.07 
##  2 NA       0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705 NA     -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  NA    
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97  NA    
##  9 NA       0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>Pretty nice, right?</p>
<p>Before moving on, I want to point out that we did not have to create the <code>add_na_at()</code> function ahead of time the way we did. If we didn’t think we would need to use <code>add_na_at()</code> in any other part of our program, we might have decided to pass the code inside of <code>add_na_at()</code> to the <code>.f</code> argument as an anonymous function instead.</p>
<p>As a reminder, here is what our <em>named</em> function looks like:</p>
<div class="sourceCode" id="cb1638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1638-1"><a href="using-the-purrr-package.html#cb1638-1" tabindex="-1"></a>add_na_at <span class="ot">&lt;-</span> <span class="cf">function</span>(vect, pos) {</span>
<span id="cb1638-2"><a href="using-the-purrr-package.html#cb1638-2" tabindex="-1"></a>  vect[[pos]] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1638-3"><a href="using-the-purrr-package.html#cb1638-3" tabindex="-1"></a>  vect</span>
<span id="cb1638-4"><a href="using-the-purrr-package.html#cb1638-4" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is what our <code>purrr</code> code would look like if we used an <em>anonymous</em> function instead:</p>
<div class="sourceCode" id="cb1639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1639-1"><a href="using-the-purrr-package.html#cb1639-1" tabindex="-1"></a><span class="fu">map2_dfc</span>(</span>
<span id="cb1639-2"><a href="using-the-purrr-package.html#cb1639-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1639-3"><a href="using-the-purrr-package.html#cb1639-3" tabindex="-1"></a>  <span class="at">.y =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>),</span>
<span id="cb1639-4"><a href="using-the-purrr-package.html#cb1639-4" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(vect, pos) {</span>
<span id="cb1639-5"><a href="using-the-purrr-package.html#cb1639-5" tabindex="-1"></a>    vect[[pos]] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1639-6"><a href="using-the-purrr-package.html#cb1639-6" tabindex="-1"></a>    vect</span>
<span id="cb1639-7"><a href="using-the-purrr-package.html#cb1639-7" tabindex="-1"></a>  }</span>
<span id="cb1639-8"><a href="using-the-purrr-package.html#cb1639-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 NA       0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705 NA     -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  NA    
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>Or, if we used a purrr-style lambda anonymous function instead:</p>
<div class="sourceCode" id="cb1641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1641-1"><a href="using-the-purrr-package.html#cb1641-1" tabindex="-1"></a><span class="fu">map2_dfc</span>(</span>
<span id="cb1641-2"><a href="using-the-purrr-package.html#cb1641-2" tabindex="-1"></a>  <span class="at">.x =</span> df_xyz,</span>
<span id="cb1641-3"><a href="using-the-purrr-package.html#cb1641-3" tabindex="-1"></a>  <span class="at">.y =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>),</span>
<span id="cb1641-4"><a href="using-the-purrr-package.html#cb1641-4" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> {</span>
<span id="cb1641-5"><a href="using-the-purrr-package.html#cb1641-5" tabindex="-1"></a>    .x[[.y]] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1641-6"><a href="using-the-purrr-package.html#cb1641-6" tabindex="-1"></a>    .x</span>
<span id="cb1641-7"><a href="using-the-purrr-package.html#cb1641-7" tabindex="-1"></a>  }</span>
<span id="cb1641-8"><a href="using-the-purrr-package.html#cb1641-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 NA       0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705 NA     -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  NA    
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>Whichever style you choose to use is largely just a matter of preference in this case (as it is in many cases).</p>
</div>
<div id="example-2.-detecting-matching-values-by-position" class="section level3 hasAnchor" number="37.3.2">
<h3><span class="header-section-number">37.3.2</span> Example 2. Detecting matching values by position<a href="using-the-purrr-package.html#example-2.-detecting-matching-values-by-position" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the <a href="writing-functions.html#the-function-writing-process">chapter on writing functions</a>, we created an <code>is_match()</code> function. In that scenario, we wanted to see if first name, last name, and street name matched at each ID between our data frames. More specifically, we wanted to combine the two data frames into a single data frame and create three new dummy variables that indicated whether first name, last name, and address matched respectively.</p>
<p>Here are the data frames we simulated and combined:</p>
<div class="sourceCode" id="cb1643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1643-1"><a href="using-the-purrr-package.html#cb1643-1" tabindex="-1"></a>people_1 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1643-2"><a href="using-the-purrr-package.html#cb1643-2" tabindex="-1"></a>  <span class="sc">~</span>id_1, <span class="sc">~</span>name_first_1, <span class="sc">~</span>name_last_1, <span class="sc">~</span>street_1,</span>
<span id="cb1643-3"><a href="using-the-purrr-package.html#cb1643-3" tabindex="-1"></a>  <span class="dv">1</span>,     <span class="st">&quot;Easton&quot;</span>,      <span class="cn">NA</span>,           <span class="st">&quot;Alameda&quot;</span>,</span>
<span id="cb1643-4"><a href="using-the-purrr-package.html#cb1643-4" tabindex="-1"></a>  <span class="dv">2</span>,     <span class="st">&quot;Elias&quot;</span>,       <span class="st">&quot;Salazar&quot;</span>,    <span class="st">&quot;Crissy Field&quot;</span>,</span>
<span id="cb1643-5"><a href="using-the-purrr-package.html#cb1643-5" tabindex="-1"></a>  <span class="dv">3</span>,     <span class="st">&quot;Colton&quot;</span>,      <span class="st">&quot;Fox&quot;</span>,        <span class="st">&quot;San Bruno&quot;</span>,</span>
<span id="cb1643-6"><a href="using-the-purrr-package.html#cb1643-6" tabindex="-1"></a>  <span class="dv">4</span>,     <span class="st">&quot;Cameron&quot;</span>,     <span class="st">&quot;Warren&quot;</span>,     <span class="st">&quot;Nottingham&quot;</span>,</span>
<span id="cb1643-7"><a href="using-the-purrr-package.html#cb1643-7" tabindex="-1"></a>  <span class="dv">5</span>,     <span class="st">&quot;Carson&quot;</span>,      <span class="st">&quot;Mills&quot;</span>,      <span class="st">&quot;Jersey&quot;</span>,</span>
<span id="cb1643-8"><a href="using-the-purrr-package.html#cb1643-8" tabindex="-1"></a>  <span class="dv">6</span>,     <span class="st">&quot;Addison&quot;</span>,     <span class="st">&quot;Meyer&quot;</span>,      <span class="st">&quot;Tingley&quot;</span>,</span>
<span id="cb1643-9"><a href="using-the-purrr-package.html#cb1643-9" tabindex="-1"></a>  <span class="dv">7</span>,     <span class="st">&quot;Aubrey&quot;</span>,      <span class="st">&quot;Rice&quot;</span>,       <span class="st">&quot;Buena Vista&quot;</span>,</span>
<span id="cb1643-10"><a href="using-the-purrr-package.html#cb1643-10" tabindex="-1"></a>  <span class="dv">8</span>,     <span class="st">&quot;Ellie&quot;</span>,       <span class="st">&quot;Schmidt&quot;</span>,    <span class="st">&quot;Division&quot;</span>,</span>
<span id="cb1643-11"><a href="using-the-purrr-package.html#cb1643-11" tabindex="-1"></a>  <span class="dv">9</span>,     <span class="st">&quot;Robert&quot;</span>,      <span class="st">&quot;Garza&quot;</span>,      <span class="st">&quot;Red Rock&quot;</span>,</span>
<span id="cb1643-12"><a href="using-the-purrr-package.html#cb1643-12" tabindex="-1"></a>  <span class="dv">10</span>,    <span class="st">&quot;Stella&quot;</span>,      <span class="st">&quot;Daniels&quot;</span>,    <span class="st">&quot;Holland&quot;</span></span>
<span id="cb1643-13"><a href="using-the-purrr-package.html#cb1643-13" tabindex="-1"></a>)</span>
<span id="cb1643-14"><a href="using-the-purrr-package.html#cb1643-14" tabindex="-1"></a></span>
<span id="cb1643-15"><a href="using-the-purrr-package.html#cb1643-15" tabindex="-1"></a>people_2 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1643-16"><a href="using-the-purrr-package.html#cb1643-16" tabindex="-1"></a>  <span class="sc">~</span>id_2, <span class="sc">~</span>name_first_2, <span class="sc">~</span>name_last_2, <span class="sc">~</span>street_2,</span>
<span id="cb1643-17"><a href="using-the-purrr-package.html#cb1643-17" tabindex="-1"></a>  <span class="dv">1</span>,     <span class="st">&quot;Easton&quot;</span>,      <span class="st">&quot;Stone&quot;</span>,      <span class="st">&quot;Alameda&quot;</span>,</span>
<span id="cb1643-18"><a href="using-the-purrr-package.html#cb1643-18" tabindex="-1"></a>  <span class="dv">2</span>,     <span class="st">&quot;Elas&quot;</span>,        <span class="st">&quot;Salazar&quot;</span>,    <span class="st">&quot;Field&quot;</span>,</span>
<span id="cb1643-19"><a href="using-the-purrr-package.html#cb1643-19" tabindex="-1"></a>  <span class="dv">3</span>,     <span class="cn">NA</span>,            <span class="st">&quot;Fox&quot;</span>,        <span class="cn">NA</span>,</span>
<span id="cb1643-20"><a href="using-the-purrr-package.html#cb1643-20" tabindex="-1"></a>  <span class="dv">4</span>,     <span class="st">&quot;Cameron&quot;</span>,     <span class="st">&quot;Waren&quot;</span>,      <span class="st">&quot;Notingham&quot;</span>,</span>
<span id="cb1643-21"><a href="using-the-purrr-package.html#cb1643-21" tabindex="-1"></a>  <span class="dv">5</span>,     <span class="st">&quot;Carsen&quot;</span>,      <span class="st">&quot;Mills&quot;</span>,      <span class="st">&quot;Jersey&quot;</span>,</span>
<span id="cb1643-22"><a href="using-the-purrr-package.html#cb1643-22" tabindex="-1"></a>  <span class="dv">6</span>,     <span class="st">&quot;Adison&quot;</span>,      <span class="cn">NA</span>,           <span class="cn">NA</span>,</span>
<span id="cb1643-23"><a href="using-the-purrr-package.html#cb1643-23" tabindex="-1"></a>  <span class="dv">7</span>,     <span class="st">&quot;Aubrey&quot;</span>,      <span class="st">&quot;Rice&quot;</span>,       <span class="st">&quot;Buena Vista&quot;</span>,</span>
<span id="cb1643-24"><a href="using-the-purrr-package.html#cb1643-24" tabindex="-1"></a>  <span class="dv">8</span>,     <span class="cn">NA</span>,            <span class="st">&quot;Schmidt&quot;</span>,    <span class="st">&quot;Division&quot;</span>,</span>
<span id="cb1643-25"><a href="using-the-purrr-package.html#cb1643-25" tabindex="-1"></a>  <span class="dv">9</span>,     <span class="st">&quot;Bob&quot;</span>,         <span class="st">&quot;Garza&quot;</span>,      <span class="st">&quot;Red Rock&quot;</span>,</span>
<span id="cb1643-26"><a href="using-the-purrr-package.html#cb1643-26" tabindex="-1"></a>  <span class="dv">10</span>,    <span class="st">&quot;Stella&quot;</span>,      <span class="cn">NA</span>,           <span class="st">&quot;Holland&quot;</span></span>
<span id="cb1643-27"><a href="using-the-purrr-package.html#cb1643-27" tabindex="-1"></a>)</span>
<span id="cb1643-28"><a href="using-the-purrr-package.html#cb1643-28" tabindex="-1"></a></span>
<span id="cb1643-29"><a href="using-the-purrr-package.html#cb1643-29" tabindex="-1"></a>people <span class="ot">&lt;-</span> people_1 <span class="sc">%&gt;%</span> </span>
<span id="cb1643-30"><a href="using-the-purrr-package.html#cb1643-30" tabindex="-1"></a>  <span class="fu">bind_cols</span>(people_2) <span class="sc">%&gt;%</span> </span>
<span id="cb1643-31"><a href="using-the-purrr-package.html#cb1643-31" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##     id_1 name_first_1 name_last_1 street_1      id_2 name_first_2 name_last_2 street_2   
##    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;      
##  1     1 Easton       &lt;NA&gt;        Alameda          1 Easton       Stone       Alameda    
##  2     2 Elias        Salazar     Crissy Field     2 Elas         Salazar     Field      
##  3     3 Colton       Fox         San Bruno        3 &lt;NA&gt;         Fox         &lt;NA&gt;       
##  4     4 Cameron      Warren      Nottingham       4 Cameron      Waren       Notingham  
##  5     5 Carson       Mills       Jersey           5 Carsen       Mills       Jersey     
##  6     6 Addison      Meyer       Tingley          6 Adison       &lt;NA&gt;        &lt;NA&gt;       
##  7     7 Aubrey       Rice        Buena Vista      7 Aubrey       Rice        Buena Vista
##  8     8 Ellie        Schmidt     Division         8 &lt;NA&gt;         Schmidt     Division   
##  9     9 Robert       Garza       Red Rock         9 Bob          Garza       Red Rock   
## 10    10 Stella       Daniels     Holland         10 Stella       &lt;NA&gt;        Holland</code></pre>
<p>Here is the function we wrote to help us create the dummy variables:</p>
<div class="sourceCode" id="cb1645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1645-1"><a href="using-the-purrr-package.html#cb1645-1" tabindex="-1"></a>is_match <span class="ot">&lt;-</span> <span class="cf">function</span>(value_1, value_2) {</span>
<span id="cb1645-2"><a href="using-the-purrr-package.html#cb1645-2" tabindex="-1"></a>  result <span class="ot">&lt;-</span> value_1 <span class="sc">==</span> value_2</span>
<span id="cb1645-3"><a href="using-the-purrr-package.html#cb1645-3" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(result), <span class="cn">FALSE</span>, result)</span>
<span id="cb1645-4"><a href="using-the-purrr-package.html#cb1645-4" tabindex="-1"></a>  result</span>
<span id="cb1645-5"><a href="using-the-purrr-package.html#cb1645-5" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is how we applied the function we wrote to get our results:</p>
<div class="sourceCode" id="cb1646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1646-1"><a href="using-the-purrr-package.html#cb1646-1" tabindex="-1"></a>people <span class="sc">%&gt;%</span> </span>
<span id="cb1646-2"><a href="using-the-purrr-package.html#cb1646-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1646-3"><a href="using-the-purrr-package.html#cb1646-3" tabindex="-1"></a>    <span class="at">name_first_match =</span> <span class="fu">is_match</span>(name_first_1, name_first_2),</span>
<span id="cb1646-4"><a href="using-the-purrr-package.html#cb1646-4" tabindex="-1"></a>    <span class="at">name_last_match  =</span> <span class="fu">is_match</span>(name_last_1, name_last_2),</span>
<span id="cb1646-5"><a href="using-the-purrr-package.html#cb1646-5" tabindex="-1"></a>    <span class="at">street_match     =</span> <span class="fu">is_match</span>(street_1, street_2)</span>
<span id="cb1646-6"><a href="using-the-purrr-package.html#cb1646-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1646-7"><a href="using-the-purrr-package.html#cb1646-7" tabindex="-1"></a>  <span class="co"># Order like columns next to each other for easier comparison</span></span>
<span id="cb1646-8"><a href="using-the-purrr-package.html#cb1646-8" tabindex="-1"></a>  <span class="fu">select</span>(id_1, <span class="fu">starts_with</span>(<span class="st">&quot;name_f&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;name_l&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;s&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##     id_1 name_first_1 name_first_2 name_first_match name_last_1 name_last_2 name_last_match street_1     street_2    street_match
##    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;lgl&gt;            &lt;chr&gt;       &lt;chr&gt;       &lt;lgl&gt;           &lt;chr&gt;        &lt;chr&gt;       &lt;lgl&gt;       
##  1     1 Easton       Easton       TRUE             &lt;NA&gt;        Stone       FALSE           Alameda      Alameda     TRUE        
##  2     2 Elias        Elas         FALSE            Salazar     Salazar     TRUE            Crissy Field Field       FALSE       
##  3     3 Colton       &lt;NA&gt;         FALSE            Fox         Fox         TRUE            San Bruno    &lt;NA&gt;        FALSE       
##  4     4 Cameron      Cameron      TRUE             Warren      Waren       FALSE           Nottingham   Notingham   FALSE       
##  5     5 Carson       Carsen       FALSE            Mills       Mills       TRUE            Jersey       Jersey      TRUE        
##  6     6 Addison      Adison       FALSE            Meyer       &lt;NA&gt;        FALSE           Tingley      &lt;NA&gt;        FALSE       
##  7     7 Aubrey       Aubrey       TRUE             Rice        Rice        TRUE            Buena Vista  Buena Vista TRUE        
##  8     8 Ellie        &lt;NA&gt;         FALSE            Schmidt     Schmidt     TRUE            Division     Division    TRUE        
##  9     9 Robert       Bob          FALSE            Garza       Garza       TRUE            Red Rock     Red Rock    TRUE        
## 10    10 Stella       Stella       TRUE             Daniels     &lt;NA&gt;        FALSE           Holland      Holland     TRUE</code></pre>
<p>🚩However, in the code chunk above, we still have essentially the same code copied more than twice. That’s a red flag that we should be thinking about removing unnecessary repetition from our code. Because we are using dplyr, and all of our data resides inside of a single data frame, your first instinct might be to use <code>across()</code> inside of <code>mutate()</code> to perform column-wise operations. Unfortunately, that method won’t work in this scenario.</p>
<p>The <code>across()</code> function will apply the function we pass to the <code>.fns</code> argument to each column passed to the <code>.cols</code> argument, one at a time. But, we need to pass two columns at a time to the <code>is_match()</code> function. For example, <code>name_first_1</code> <em>and</em> <code>name_first_2</code>. That makes this task a little trickier than most. But, here’s how we accomplished it using a for loop:</p>
<div class="sourceCode" id="cb1648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1648-1"><a href="using-the-purrr-package.html#cb1648-1" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>)</span>
<span id="cb1648-2"><a href="using-the-purrr-package.html#cb1648-2" tabindex="-1"></a></span>
<span id="cb1648-3"><a href="using-the-purrr-package.html#cb1648-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(cols)) {</span>
<span id="cb1648-4"><a href="using-the-purrr-package.html#cb1648-4" tabindex="-1"></a>  col_1   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1648-5"><a href="using-the-purrr-package.html#cb1648-5" tabindex="-1"></a>  col_2   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1648-6"><a href="using-the-purrr-package.html#cb1648-6" tabindex="-1"></a>  new_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_match&quot;</span>)</span>
<span id="cb1648-7"><a href="using-the-purrr-package.html#cb1648-7" tabindex="-1"></a>  people[[new_col]] <span class="ot">&lt;-</span> <span class="fu">is_match</span>(people[[col_1]], people[[col_2]])</span>
<span id="cb1648-8"><a href="using-the-purrr-package.html#cb1648-8" tabindex="-1"></a>}</span>
<span id="cb1648-9"><a href="using-the-purrr-package.html#cb1648-9" tabindex="-1"></a></span>
<span id="cb1648-10"><a href="using-the-purrr-package.html#cb1648-10" tabindex="-1"></a>people <span class="sc">%&gt;%</span> </span>
<span id="cb1648-11"><a href="using-the-purrr-package.html#cb1648-11" tabindex="-1"></a>  <span class="fu">select</span>(id_1, <span class="fu">starts_with</span>(<span class="st">&quot;name_f&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;name_l&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;s&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##     id_1 name_first_1 name_first_2 name_first_match name_last_1 name_last_2 name_last_match street_1     street_2    street_match
##    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;lgl&gt;            &lt;chr&gt;       &lt;chr&gt;       &lt;lgl&gt;           &lt;chr&gt;        &lt;chr&gt;       &lt;lgl&gt;       
##  1     1 Easton       Easton       TRUE             &lt;NA&gt;        Stone       FALSE           Alameda      Alameda     TRUE        
##  2     2 Elias        Elas         FALSE            Salazar     Salazar     TRUE            Crissy Field Field       FALSE       
##  3     3 Colton       &lt;NA&gt;         FALSE            Fox         Fox         TRUE            San Bruno    &lt;NA&gt;        FALSE       
##  4     4 Cameron      Cameron      TRUE             Warren      Waren       FALSE           Nottingham   Notingham   FALSE       
##  5     5 Carson       Carsen       FALSE            Mills       Mills       TRUE            Jersey       Jersey      TRUE        
##  6     6 Addison      Adison       FALSE            Meyer       &lt;NA&gt;        FALSE           Tingley      &lt;NA&gt;        FALSE       
##  7     7 Aubrey       Aubrey       TRUE             Rice        Rice        TRUE            Buena Vista  Buena Vista TRUE        
##  8     8 Ellie        &lt;NA&gt;         FALSE            Schmidt     Schmidt     TRUE            Division     Division    TRUE        
##  9     9 Robert       Bob          FALSE            Garza       Garza       TRUE            Red Rock     Red Rock    TRUE        
## 10    10 Stella       Stella       TRUE             Daniels     &lt;NA&gt;        FALSE           Holland      Holland     TRUE</code></pre>
<p>Now, let’s go over one way to get the same result using <code>purrr</code>. The first method very closely resembles our for loop. In fact, we will basically just copy and paste our for loop body into an anonymous function being passed to the <code>.f</code> argument:</p>
<div class="sourceCode" id="cb1650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1650-1"><a href="using-the-purrr-package.html#cb1650-1" tabindex="-1"></a><span class="fu">map_dfc</span>(</span>
<span id="cb1650-2"><a href="using-the-purrr-package.html#cb1650-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>),</span>
<span id="cb1650-3"><a href="using-the-purrr-package.html#cb1650-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(col, <span class="at">data =</span> people) {</span>
<span id="cb1650-4"><a href="using-the-purrr-package.html#cb1650-4" tabindex="-1"></a>    col_1 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(col, <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1650-5"><a href="using-the-purrr-package.html#cb1650-5" tabindex="-1"></a>    col_2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(col, <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1650-6"><a href="using-the-purrr-package.html#cb1650-6" tabindex="-1"></a>    new_nm <span class="ot">&lt;-</span> <span class="fu">paste0</span>(col, <span class="st">&quot;_match&quot;</span>)</span>
<span id="cb1650-7"><a href="using-the-purrr-package.html#cb1650-7" tabindex="-1"></a>    data[[new_nm]] <span class="ot">&lt;-</span> data[[col_1]] <span class="sc">==</span> data[[col_2]]</span>
<span id="cb1650-8"><a href="using-the-purrr-package.html#cb1650-8" tabindex="-1"></a>    data[[new_nm]] <span class="ot">&lt;-</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(data[[new_nm]]), <span class="cn">FALSE</span>, data[[new_nm]])</span>
<span id="cb1650-9"><a href="using-the-purrr-package.html#cb1650-9" tabindex="-1"></a>    data[<span class="fu">c</span>(col_1, col_2, new_nm)]</span>
<span id="cb1650-10"><a href="using-the-purrr-package.html#cb1650-10" tabindex="-1"></a>  }</span>
<span id="cb1650-11"><a href="using-the-purrr-package.html#cb1650-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 9
##    name_first_1 name_first_2 name_first_match name_last_1 name_last_2 name_last_match street_1     street_2    street_match
##    &lt;chr&gt;        &lt;chr&gt;        &lt;lgl&gt;            &lt;chr&gt;       &lt;chr&gt;       &lt;lgl&gt;           &lt;chr&gt;        &lt;chr&gt;       &lt;lgl&gt;       
##  1 Easton       Easton       TRUE             &lt;NA&gt;        Stone       FALSE           Alameda      Alameda     TRUE        
##  2 Elias        Elas         FALSE            Salazar     Salazar     TRUE            Crissy Field Field       FALSE       
##  3 Colton       &lt;NA&gt;         FALSE            Fox         Fox         TRUE            San Bruno    &lt;NA&gt;        FALSE       
##  4 Cameron      Cameron      TRUE             Warren      Waren       FALSE           Nottingham   Notingham   FALSE       
##  5 Carson       Carsen       FALSE            Mills       Mills       TRUE            Jersey       Jersey      TRUE        
##  6 Addison      Adison       FALSE            Meyer       &lt;NA&gt;        FALSE           Tingley      &lt;NA&gt;        FALSE       
##  7 Aubrey       Aubrey       TRUE             Rice        Rice        TRUE            Buena Vista  Buena Vista TRUE        
##  8 Ellie        &lt;NA&gt;         FALSE            Schmidt     Schmidt     TRUE            Division     Division    TRUE        
##  9 Robert       Bob          FALSE            Garza       Garza       TRUE            Red Rock     Red Rock    TRUE        
## 10 Stella       Stella       TRUE             Daniels     &lt;NA&gt;        FALSE           Holland      Holland     TRUE</code></pre>
<p>In the code above, we used roughly the same amount of code to complete the task with a loop that we used to complete it without a loop. However, this code still has some advantages. We only typed “name_first”, “name_last”, and “street” once at the beginning of the code chunk. Therefore, we didn’t have to worry about forgetting to change a column name after copying and pasting code. Additionally, if we later decide that we also want to compare other columns (e.g., middle name, birth date, city, state, zip code), we only have to update the code in one place – where we create the <code>cols</code> vector.</p>
</div>
</div>
<div id="using-purrr-for-analysis" class="section level2 hasAnchor" number="37.4">
<h2><span class="header-section-number">37.4</span> Using purrr for analysis<a href="using-the-purrr-package.html#using-purrr-for-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s return to the examples from the <a href="column-wise-operations-in-dplyr.html#across-with-summarise">column-wise operations chapter</a> and the <a href="writing-for-loops.html#using-for-loops-for-analysis">chapter on writing for loops</a> for our discussion of using the <code>purrr</code> package to remove unnecessary repetition from our analyses. We will once again use the simulated for the examples below.</p>
<div class="sourceCode" id="cb1652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1652-1"><a href="using-the-purrr-package.html#cb1652-1" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1652-2"><a href="using-the-purrr-package.html#cb1652-2" tabindex="-1"></a>  <span class="at">age       =</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">38</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">48</span>, <span class="dv">29</span>, <span class="dv">22</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">24</span>, <span class="dv">25</span>, </span>
<span id="cb1652-3"><a href="using-the-purrr-package.html#cb1652-3" tabindex="-1"></a>                <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">23</span>, </span>
<span id="cb1652-4"><a href="using-the-purrr-package.html#cb1652-4" tabindex="-1"></a>                <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">33</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">43</span>, <span class="dv">25</span>, <span class="dv">24</span>, </span>
<span id="cb1652-5"><a href="using-the-purrr-package.html#cb1652-5" tabindex="-1"></a>                <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">31</span>, <span class="dv">34</span>, </span>
<span id="cb1652-6"><a href="using-the-purrr-package.html#cb1652-6" tabindex="-1"></a>                <span class="dv">26</span>, <span class="dv">25</span>, <span class="dv">27</span>, <span class="cn">NA</span>),</span>
<span id="cb1652-7"><a href="using-the-purrr-package.html#cb1652-7" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1652-8"><a href="using-the-purrr-package.html#cb1652-8" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1652-9"><a href="using-the-purrr-package.html#cb1652-9" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, </span>
<span id="cb1652-10"><a href="using-the-purrr-package.html#cb1652-10" tabindex="-1"></a>                <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>),</span>
<span id="cb1652-11"><a href="using-the-purrr-package.html#cb1652-11" tabindex="-1"></a>  <span class="at">gender    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1652-12"><a href="using-the-purrr-package.html#cb1652-12" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb1652-13"><a href="using-the-purrr-package.html#cb1652-13" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb1652-14"><a href="using-the-purrr-package.html#cb1652-14" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="cn">NA</span>),</span>
<span id="cb1652-15"><a href="using-the-purrr-package.html#cb1652-15" tabindex="-1"></a>  <span class="at">ht_in     =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">63</span>, <span class="dv">62</span>, <span class="dv">67</span>, <span class="dv">67</span>, <span class="dv">58</span>, <span class="dv">64</span>, <span class="dv">69</span>, <span class="dv">65</span>, <span class="dv">68</span>, <span class="dv">63</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">65</span>, </span>
<span id="cb1652-16"><a href="using-the-purrr-package.html#cb1652-16" tabindex="-1"></a>                <span class="dv">64</span>, <span class="dv">75</span>, <span class="dv">67</span>, <span class="dv">63</span>, <span class="dv">60</span>, <span class="dv">67</span>, <span class="dv">64</span>, <span class="dv">73</span>, <span class="dv">62</span>, <span class="dv">69</span>, <span class="dv">67</span>, <span class="dv">62</span>, <span class="dv">68</span>, <span class="dv">66</span>, <span class="dv">66</span>, <span class="dv">62</span>, </span>
<span id="cb1652-17"><a href="using-the-purrr-package.html#cb1652-17" tabindex="-1"></a>                <span class="dv">64</span>, <span class="dv">68</span>, <span class="cn">NA</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">68</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">63</span>, <span class="dv">67</span>, <span class="dv">66</span>, </span>
<span id="cb1652-18"><a href="using-the-purrr-package.html#cb1652-18" tabindex="-1"></a>                <span class="dv">69</span>, <span class="dv">76</span>, <span class="cn">NA</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">71</span>, <span class="dv">66</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">71</span>, <span class="dv">64</span>, <span class="dv">71</span>, <span class="dv">60</span>, <span class="dv">62</span>, </span>
<span id="cb1652-19"><a href="using-the-purrr-package.html#cb1652-19" tabindex="-1"></a>                <span class="dv">61</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="cn">NA</span>),</span>
<span id="cb1652-20"><a href="using-the-purrr-package.html#cb1652-20" tabindex="-1"></a>  <span class="at">wt_lbs    =</span> <span class="fu">c</span>(<span class="dv">216</span>, <span class="dv">106</span>, <span class="dv">145</span>, <span class="dv">195</span>, <span class="dv">143</span>, <span class="dv">125</span>, <span class="dv">138</span>, <span class="dv">140</span>, <span class="dv">158</span>, <span class="dv">167</span>, <span class="dv">145</span>, <span class="dv">297</span>, <span class="dv">146</span>, </span>
<span id="cb1652-21"><a href="using-the-purrr-package.html#cb1652-21" tabindex="-1"></a>                <span class="dv">125</span>, <span class="dv">111</span>, <span class="dv">125</span>, <span class="dv">130</span>, <span class="dv">182</span>, <span class="dv">170</span>, <span class="dv">121</span>, <span class="dv">98</span>, <span class="dv">150</span>, <span class="dv">132</span>, <span class="dv">250</span>, <span class="dv">137</span>, <span class="dv">124</span>, </span>
<span id="cb1652-22"><a href="using-the-purrr-package.html#cb1652-22" tabindex="-1"></a>                <span class="dv">186</span>, <span class="dv">148</span>, <span class="dv">134</span>, <span class="dv">155</span>, <span class="dv">122</span>, <span class="dv">142</span>, <span class="dv">110</span>, <span class="dv">132</span>, <span class="dv">188</span>, <span class="dv">176</span>, <span class="dv">188</span>, <span class="dv">166</span>, <span class="dv">136</span>, </span>
<span id="cb1652-23"><a href="using-the-purrr-package.html#cb1652-23" tabindex="-1"></a>                <span class="dv">147</span>, <span class="dv">178</span>, <span class="dv">125</span>, <span class="dv">102</span>, <span class="dv">140</span>, <span class="dv">139</span>, <span class="dv">60</span>, <span class="dv">147</span>, <span class="dv">147</span>, <span class="dv">141</span>, <span class="dv">232</span>, <span class="dv">186</span>, <span class="dv">212</span>, </span>
<span id="cb1652-24"><a href="using-the-purrr-package.html#cb1652-24" tabindex="-1"></a>                <span class="dv">110</span>, <span class="dv">110</span>, <span class="dv">115</span>, <span class="dv">154</span>, <span class="dv">140</span>, <span class="dv">150</span>, <span class="dv">130</span>, <span class="cn">NA</span>, <span class="dv">171</span>, <span class="dv">156</span>, <span class="dv">92</span>, <span class="dv">122</span>, <span class="dv">102</span>, </span>
<span id="cb1652-25"><a href="using-the-purrr-package.html#cb1652-25" tabindex="-1"></a>                <span class="dv">163</span>, <span class="dv">141</span>, <span class="cn">NA</span>),</span>
<span id="cb1652-26"><a href="using-the-purrr-package.html#cb1652-26" tabindex="-1"></a>  <span class="at">bmi       =</span> <span class="fu">c</span>(<span class="fl">30.99</span>, <span class="fl">18.78</span>, <span class="fl">26.52</span>, <span class="fl">30.54</span>, <span class="fl">22.39</span>, <span class="fl">26.12</span>, <span class="fl">23.69</span>, <span class="fl">20.67</span>, <span class="fl">26.29</span>, </span>
<span id="cb1652-27"><a href="using-the-purrr-package.html#cb1652-27" tabindex="-1"></a>                <span class="fl">25.39</span>, <span class="fl">25.68</span>, <span class="fl">45.15</span>, <span class="fl">21.56</span>, <span class="fl">20.17</span>, <span class="fl">17.38</span>, <span class="fl">20.8</span>, <span class="fl">22.31</span>, <span class="fl">22.75</span>, </span>
<span id="cb1652-28"><a href="using-the-purrr-package.html#cb1652-28" tabindex="-1"></a>                <span class="fl">26.62</span>, <span class="fl">21.43</span>, <span class="fl">19.14</span>, <span class="fl">23.49</span>, <span class="fl">22.66</span>, <span class="fl">32.98</span>, <span class="fl">25.05</span>, <span class="fl">18.31</span>, <span class="fl">29.13</span>, </span>
<span id="cb1652-29"><a href="using-the-purrr-package.html#cb1652-29" tabindex="-1"></a>                <span class="fl">27.07</span>, <span class="fl">20.37</span>, <span class="fl">25.01</span>, <span class="fl">19.69</span>, <span class="fl">25.97</span>, <span class="fl">18.88</span>, <span class="fl">20.07</span>, <span class="cn">NA</span>, <span class="fl">26.76</span>, </span>
<span id="cb1652-30"><a href="using-the-purrr-package.html#cb1652-30" tabindex="-1"></a>                <span class="fl">26.97</span>, <span class="fl">25.24</span>, <span class="fl">20.68</span>, <span class="fl">23.72</span>, <span class="fl">24.82</span>, <span class="fl">23.62</span>, <span class="fl">18.65</span>, <span class="fl">24.03</span>, <span class="fl">23.86</span>, </span>
<span id="cb1652-31"><a href="using-the-purrr-package.html#cb1652-31" tabindex="-1"></a>                <span class="fl">10.63</span>, <span class="fl">23.02</span>, <span class="fl">23.72</span>, <span class="fl">20.82</span>, <span class="fl">28.24</span>, <span class="cn">NA</span>, <span class="fl">37.55</span>, <span class="fl">18.88</span>, <span class="fl">18.3</span>, </span>
<span id="cb1652-32"><a href="using-the-purrr-package.html#cb1652-32" tabindex="-1"></a>                <span class="fl">19.13</span>, <span class="fl">21.48</span>, <span class="fl">22.59</span>, <span class="fl">24.96</span>, <span class="fl">21.63</span>, <span class="cn">NA</span>, <span class="fl">29.35</span>, <span class="fl">21.76</span>, <span class="fl">17.97</span>, </span>
<span id="cb1652-33"><a href="using-the-purrr-package.html#cb1652-33" tabindex="-1"></a>                <span class="fl">22.31</span>, <span class="fl">19.27</span>, <span class="fl">24.07</span>, <span class="fl">22.76</span>, <span class="cn">NA</span>),</span>
<span id="cb1652-34"><a href="using-the-purrr-package.html#cb1652-34" tabindex="-1"></a>  <span class="at">bmi_3cat  =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1652-35"><a href="using-the-purrr-package.html#cb1652-35" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1652-36"><a href="using-the-purrr-package.html#cb1652-36" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb1652-37"><a href="using-the-purrr-package.html#cb1652-37" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>)</span>
<span id="cb1652-38"><a href="using-the-purrr-package.html#cb1652-38" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1652-39"><a href="using-the-purrr-package.html#cb1652-39" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1652-40"><a href="using-the-purrr-package.html#cb1652-40" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">factor</span>(age_group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Younger than 30&quot;</span>, <span class="st">&quot;30 and Older&quot;</span>)),</span>
<span id="cb1652-41"><a href="using-the-purrr-package.html#cb1652-41" tabindex="-1"></a>    <span class="at">gender    =</span> <span class="fu">factor</span>(gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)),</span>
<span id="cb1652-42"><a href="using-the-purrr-package.html#cb1652-42" tabindex="-1"></a>    <span class="at">bmi_3cat  =</span> <span class="fu">factor</span>(bmi_3cat, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;Overweight&quot;</span>, <span class="st">&quot;Obese&quot;</span>))</span>
<span id="cb1652-43"><a href="using-the-purrr-package.html#cb1652-43" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1652-44"><a href="using-the-purrr-package.html#cb1652-44" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 68 × 7
##      age age_group       gender ht_in wt_lbs   bmi bmi_3cat  
##    &lt;dbl&gt; &lt;fct&gt;           &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     
##  1    32 30 and Older    Male      70    216  31.0 Obese     
##  2    30 30 and Older    Female    63    106  18.8 Normal    
##  3    32 30 and Older    Female    62    145  26.5 Overweight
##  4    29 Younger than 30 Male      67    195  30.5 Obese     
##  5    24 Younger than 30 Female    67    143  22.4 Normal    
##  6    38 30 and Older    Female    58    125  26.1 Overweight
##  7    25 Younger than 30 Female    64    138  23.7 Normal    
##  8    24 Younger than 30 Male      69    140  20.7 Normal    
##  9    48 30 and Older    Male      65    158  26.3 Overweight
## 10    29 Younger than 30 Male      68    167  25.4 Overweight
## # ℹ 58 more rows</code></pre>
<div id="example-1-continuous-statistics" class="section level3 hasAnchor" number="37.4.1">
<h3><span class="header-section-number">37.4.1</span> Example 1: Continuous statistics<a href="using-the-purrr-package.html#example-1-continuous-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this first example, we will use <code>purrr</code> to calculate a set of statistics for multiple continuous variables in our data frame. We will start by creating the same function we created at the beginning of the <a href="writing-functions.html#writing-functions">chapter on writing functions</a>.</p>
<div class="sourceCode" id="cb1654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1654-1"><a href="using-the-purrr-package.html#cb1654-1" tabindex="-1"></a>continuous_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(var) {</span>
<span id="cb1654-2"><a href="using-the-purrr-package.html#cb1654-2" tabindex="-1"></a>  study <span class="sc">%&gt;%</span> </span>
<span id="cb1654-3"><a href="using-the-purrr-package.html#cb1654-3" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb1654-4"><a href="using-the-purrr-package.html#cb1654-4" tabindex="-1"></a>      <span class="at">n_miss =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>({{ var }})),</span>
<span id="cb1654-5"><a href="using-the-purrr-package.html#cb1654-5" tabindex="-1"></a>      <span class="at">mean   =</span> <span class="fu">mean</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1654-6"><a href="using-the-purrr-package.html#cb1654-6" tabindex="-1"></a>      <span class="at">median =</span> <span class="fu">median</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1654-7"><a href="using-the-purrr-package.html#cb1654-7" tabindex="-1"></a>      <span class="at">min    =</span> <span class="fu">min</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1654-8"><a href="using-the-purrr-package.html#cb1654-8" tabindex="-1"></a>      <span class="at">max    =</span> <span class="fu">max</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1654-9"><a href="using-the-purrr-package.html#cb1654-9" tabindex="-1"></a>    )</span>
<span id="cb1654-10"><a href="using-the-purrr-package.html#cb1654-10" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, let’s once again <em>use</em> the function we just created above to calculate the descriptive measures we are interested in.</p>
<div class="sourceCode" id="cb1655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1655-1"><a href="using-the-purrr-package.html#cb1655-1" tabindex="-1"></a><span class="fu">continuous_stats</span>(age)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   n_miss  mean median   min   max
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1      1  26.9     26    22    48</code></pre>
<div class="sourceCode" id="cb1657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1657-1"><a href="using-the-purrr-package.html#cb1657-1" tabindex="-1"></a><span class="fu">continuous_stats</span>(ht_in)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   n_miss  mean median   min   max
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1      3  66.0     66    58    76</code></pre>
<div class="sourceCode" id="cb1659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1659-1"><a href="using-the-purrr-package.html#cb1659-1" tabindex="-1"></a><span class="fu">continuous_stats</span>(wt_lbs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   n_miss  mean median   min   max
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1      2  148.   142.    60   297</code></pre>
<div class="sourceCode" id="cb1661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1661-1"><a href="using-the-purrr-package.html#cb1661-1" tabindex="-1"></a><span class="fu">continuous_stats</span>(bmi)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   n_miss  mean median   min   max
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1      4  23.6   22.9  10.6  45.2</code></pre>
<p>🚩Once again, you notice that we have essentially the same code copied more than twice. That’s a red flag that we should be thinking about removing unnecessary repetition. We’ve already seen how to accomplish this goal using the <code>across()</code> function. Now, let’s learn how to accomplish this goal using the <code>purrr</code> package.</p>
<div class="sourceCode" id="cb1663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1663-1"><a href="using-the-purrr-package.html#cb1663-1" tabindex="-1"></a><span class="fu">map_dfr</span>(</span>
<span id="cb1663-2"><a href="using-the-purrr-package.html#cb1663-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">quos</span>(age, ht_in, wt_lbs, bmi),</span>
<span id="cb1663-3"><a href="using-the-purrr-package.html#cb1663-3" tabindex="-1"></a>  <span class="at">.f =</span> continuous_stats</span>
<span id="cb1663-4"><a href="using-the-purrr-package.html#cb1663-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
##   n_miss  mean median   min   max
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1      1  26.9   26    22    48  
## 2      3  66.0   66    58    76  
## 3      2 148.   142.   60   297  
## 4      4  23.6   22.9  10.6  45.2</code></pre>
<p>👆<strong>Here’s what we did above:</strong></p>
<ul>
<li><p>We used the <code>map_dfr()</code> function from the <code>purrr</code> package to iteratively pass the columns <code>age</code>, <code>ht_in</code>, <code>wt_lbs</code>, and <code>bmi</code> to our <code>continuous_stats</code> function <em>and</em> row-bind the results into a single results data frame.</p></li>
<li><p>We haven’t seen the <code>quos()</code> function before. It’s another one of those tidy evaluation functions. You can type <code>?rlang::quos</code> in your console to read more about it. When we can wrap a single column name with the <code>quo()</code> function, or a list of column names with the <code>quos()</code> function, we are telling R to look for them in the data frame being passed to a <code>dplyr</code> verb rather than looking for them as objects in the global environment.</p></li>
</ul>
<p>At this point, you may be wondering which row in the results data frame above corresponds to which variable? Great question! When we were using <code>continuous_stats()</code> to analyze one variable at a time, it didn’t really matter that the variable name wasn’t part of the output. However, now that we are apply <code>continuous_stats()</code> to multiple columns, it would really be nice to have the column name in the results. Luckily, we can easily make that happen with one small tweak to our <code>continuous_stats()</code> function.</p>
<div class="sourceCode" id="cb1665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1665-1"><a href="using-the-purrr-package.html#cb1665-1" tabindex="-1"></a>continuous_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(var) {</span>
<span id="cb1665-2"><a href="using-the-purrr-package.html#cb1665-2" tabindex="-1"></a>  study <span class="sc">%&gt;%</span> </span>
<span id="cb1665-3"><a href="using-the-purrr-package.html#cb1665-3" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb1665-4"><a href="using-the-purrr-package.html#cb1665-4" tabindex="-1"></a>      <span class="at">variable =</span> <span class="fu">quo_name</span>(var), <span class="co"># Add variable name to the output</span></span>
<span id="cb1665-5"><a href="using-the-purrr-package.html#cb1665-5" tabindex="-1"></a>      <span class="at">n_miss   =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>({{ var }})),</span>
<span id="cb1665-6"><a href="using-the-purrr-package.html#cb1665-6" tabindex="-1"></a>      <span class="at">mean     =</span> <span class="fu">mean</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1665-7"><a href="using-the-purrr-package.html#cb1665-7" tabindex="-1"></a>      <span class="at">median   =</span> <span class="fu">median</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1665-8"><a href="using-the-purrr-package.html#cb1665-8" tabindex="-1"></a>      <span class="at">min      =</span> <span class="fu">min</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1665-9"><a href="using-the-purrr-package.html#cb1665-9" tabindex="-1"></a>      <span class="at">max      =</span> <span class="fu">max</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1665-10"><a href="using-the-purrr-package.html#cb1665-10" tabindex="-1"></a>    ) </span>
<span id="cb1665-11"><a href="using-the-purrr-package.html#cb1665-11" tabindex="-1"></a>}</span></code></pre></div>
<p>👆<strong>Here’s what we did above:</strong></p>
<ul>
<li>We used the <code>quo_name()</code> function to grab the name of the column being passed to the <code>summarise()</code> function and turn it into a character string. Then, we assigned that character string to column in the results data frame called <code>variable</code>. So, when the <code>age</code> column is passed to <code>summarise()</code> inside of the function body, <code>quo_name(var)</code> returns the value <code>"age"</code> and then that value is assigned to the <code>variable</code> column in the expression <code>variable = quo_name(var)</code>.</li>
</ul>
<p>Let’s try out our new and improved <code>continuous_stats()</code> function:</p>
<div class="sourceCode" id="cb1666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1666-1"><a href="using-the-purrr-package.html#cb1666-1" tabindex="-1"></a><span class="fu">map_dfr</span>(</span>
<span id="cb1666-2"><a href="using-the-purrr-package.html#cb1666-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">quos</span>(age, ht_in, wt_lbs, bmi),</span>
<span id="cb1666-3"><a href="using-the-purrr-package.html#cb1666-3" tabindex="-1"></a>  <span class="at">.f =</span> continuous_stats</span>
<span id="cb1666-4"><a href="using-the-purrr-package.html#cb1666-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 6
##   variable n_miss  mean median   min   max
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 age           1  26.9   26    22    48  
## 2 ht_in         3  66.0   66    58    76  
## 3 wt_lbs        2 148.   142.   60   297  
## 4 bmi           4  23.6   22.9  10.6  45.2</code></pre>
<p>That works great, but we’d probably like to be able to use <code>continuous_stats()</code> with other data frames too. Currently, we can’t do that because we have the <code>study</code> data frame hard-coded into our function. Luckily, we’ve already seen how to replace a hard-coded data frame by adding a <code>data</code> argument to our function like this:</p>
<div class="sourceCode" id="cb1668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1668-1"><a href="using-the-purrr-package.html#cb1668-1" tabindex="-1"></a>continuous_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var) {</span>
<span id="cb1668-2"><a href="using-the-purrr-package.html#cb1668-2" tabindex="-1"></a>  data <span class="sc">%&gt;%</span>  <span class="co"># Don&#39;t forget to replace &quot;study&quot; with &quot;data&quot; here too!</span></span>
<span id="cb1668-3"><a href="using-the-purrr-package.html#cb1668-3" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb1668-4"><a href="using-the-purrr-package.html#cb1668-4" tabindex="-1"></a>      <span class="at">variable =</span> <span class="fu">quo_name</span>(var),</span>
<span id="cb1668-5"><a href="using-the-purrr-package.html#cb1668-5" tabindex="-1"></a>      <span class="at">n_miss   =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>({{ var}} )),</span>
<span id="cb1668-6"><a href="using-the-purrr-package.html#cb1668-6" tabindex="-1"></a>      <span class="at">mean     =</span> <span class="fu">mean</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1668-7"><a href="using-the-purrr-package.html#cb1668-7" tabindex="-1"></a>      <span class="at">median   =</span> <span class="fu">median</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1668-8"><a href="using-the-purrr-package.html#cb1668-8" tabindex="-1"></a>      <span class="at">min      =</span> <span class="fu">min</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1668-9"><a href="using-the-purrr-package.html#cb1668-9" tabindex="-1"></a>      <span class="at">max      =</span> <span class="fu">max</span>({{ var }}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1668-10"><a href="using-the-purrr-package.html#cb1668-10" tabindex="-1"></a>    ) </span>
<span id="cb1668-11"><a href="using-the-purrr-package.html#cb1668-11" tabindex="-1"></a>}</span></code></pre></div>
<p>And now, we can analyze all the continuous variables in the <code>study</code> data:</p>
<div class="sourceCode" id="cb1669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1669-1"><a href="using-the-purrr-package.html#cb1669-1" tabindex="-1"></a><span class="fu">map_dfr</span>(</span>
<span id="cb1669-2"><a href="using-the-purrr-package.html#cb1669-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">quos</span>(age, ht_in, wt_lbs, bmi),</span>
<span id="cb1669-3"><a href="using-the-purrr-package.html#cb1669-3" tabindex="-1"></a>  <span class="at">.f =</span> continuous_stats, <span class="at">data =</span> study</span>
<span id="cb1669-4"><a href="using-the-purrr-package.html#cb1669-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 6
##   variable n_miss  mean median   min   max
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 age           1  26.9   26    22    48  
## 2 ht_in         3  66.0   66    58    76  
## 3 wt_lbs        2 148.   142.   60   297  
## 4 bmi           4  23.6   22.9  10.6  45.2</code></pre>
<p>And all the continuous variables in the <code>df_xyz</code> data:</p>
<div class="sourceCode" id="cb1671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1671-1"><a href="using-the-purrr-package.html#cb1671-1" tabindex="-1"></a><span class="fu">map_dfr</span>(</span>
<span id="cb1671-2"><a href="using-the-purrr-package.html#cb1671-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">quos</span>(x, y, z),</span>
<span id="cb1671-3"><a href="using-the-purrr-package.html#cb1671-3" tabindex="-1"></a>  <span class="at">.f =</span> continuous_stats, <span class="at">data =</span> df_xyz</span>
<span id="cb1671-4"><a href="using-the-purrr-package.html#cb1671-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   variable n_miss   mean  median   min   max
##   &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 x             1  0.108  0.0705 -1.27  1.72
## 2 y             1  0.220  0.401  -1.97  1.79
## 3 z             1 -0.284 -0.625  -1.14  1.25</code></pre>
</div>
<div id="example-2-categorical-statistics" class="section level3 hasAnchor" number="37.4.2">
<h3><span class="header-section-number">37.4.2</span> Example 2: Categorical statistics<a href="using-the-purrr-package.html#example-2-categorical-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For our second example of using the <code>purrr</code> package for analysis, we’ll once again write some code to iteratively analyze all the categorical variables in our <code>study</code> data frame. In the last chapter, we learned how to use a for loop to do this analysis. As a refresher, here is the final solution we arrived at:</p>
<div class="sourceCode" id="cb1673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1673-1"><a href="using-the-purrr-package.html#cb1673-1" tabindex="-1"></a><span class="co"># Structure 1. An object to contain the results.</span></span>
<span id="cb1673-2"><a href="using-the-purrr-package.html#cb1673-2" tabindex="-1"></a>  <span class="co"># Create the data frame structure that will contain our results</span></span>
<span id="cb1673-3"><a href="using-the-purrr-package.html#cb1673-3" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1673-4"><a href="using-the-purrr-package.html#cb1673-4" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1673-5"><a href="using-the-purrr-package.html#cb1673-5" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1673-6"><a href="using-the-purrr-package.html#cb1673-6" tabindex="-1"></a>  <span class="at">n        =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb1673-7"><a href="using-the-purrr-package.html#cb1673-7" tabindex="-1"></a>) </span>
<span id="cb1673-8"><a href="using-the-purrr-package.html#cb1673-8" tabindex="-1"></a></span>
<span id="cb1673-9"><a href="using-the-purrr-package.html#cb1673-9" tabindex="-1"></a><span class="co"># Structure 2. The actual for loop.</span></span>
<span id="cb1673-10"><a href="using-the-purrr-package.html#cb1673-10" tabindex="-1"></a>  <span class="co"># For each column, get the column name, category names, and count.</span></span>
<span id="cb1673-11"><a href="using-the-purrr-package.html#cb1673-11" tabindex="-1"></a>  <span class="co"># Then, add them to the bottom of the results data frame we created above.</span></span>
<span id="cb1673-12"><a href="using-the-purrr-package.html#cb1673-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)) {</span>
<span id="cb1673-13"><a href="using-the-purrr-package.html#cb1673-13" tabindex="-1"></a>  cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1673-14"><a href="using-the-purrr-package.html#cb1673-14" tabindex="-1"></a>    <span class="fu">count</span>(.data[[i]]) <span class="sc">%&gt;%</span> <span class="co"># Use .data to refer to the current data frame.</span></span>
<span id="cb1673-15"><a href="using-the-purrr-package.html#cb1673-15" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="co"># Use . to refer to the current data frame.</span></span>
<span id="cb1673-16"><a href="using-the-purrr-package.html#cb1673-16" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1673-17"><a href="using-the-purrr-package.html#cb1673-17" tabindex="-1"></a>  </span>
<span id="cb1673-18"><a href="using-the-purrr-package.html#cb1673-18" tabindex="-1"></a>  <span class="co"># Here is where we update cat_table with the results for each column</span></span>
<span id="cb1673-19"><a href="using-the-purrr-package.html#cb1673-19" tabindex="-1"></a>  cat_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cat_table, cat_stats)</span>
<span id="cb1673-20"><a href="using-the-purrr-package.html#cb1673-20" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1674-1"><a href="using-the-purrr-package.html#cb1674-1" tabindex="-1"></a>cat_table</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>To use <code>purrr</code> instead, we can pretty much copy and paste the code from the for loop body above as an anonymous function to the <code>.f</code> argument to <code>map_dfr()</code> like this:</p>
<div class="sourceCode" id="cb1676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1676-1"><a href="using-the-purrr-package.html#cb1676-1" tabindex="-1"></a><span class="fu">map_dfr</span>(</span>
<span id="cb1676-2"><a href="using-the-purrr-package.html#cb1676-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>),</span>
<span id="cb1676-3"><a href="using-the-purrr-package.html#cb1676-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb1676-4"><a href="using-the-purrr-package.html#cb1676-4" tabindex="-1"></a>    study <span class="sc">%&gt;%</span> </span>
<span id="cb1676-5"><a href="using-the-purrr-package.html#cb1676-5" tabindex="-1"></a>      <span class="fu">count</span>(.data[[x]]) <span class="sc">%&gt;%</span> </span>
<span id="cb1676-6"><a href="using-the-purrr-package.html#cb1676-6" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1676-7"><a href="using-the-purrr-package.html#cb1676-7" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1676-8"><a href="using-the-purrr-package.html#cb1676-8" tabindex="-1"></a>      <span class="fu">select</span>(variable, category, n)</span>
<span id="cb1676-9"><a href="using-the-purrr-package.html#cb1676-9" tabindex="-1"></a>  }</span>
<span id="cb1676-10"><a href="using-the-purrr-package.html#cb1676-10" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;fct&gt;           &lt;int&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>As you can see, the code that is <em>doing the analysis</em> is exactly the same in our for loop solution and our <code>purrr</code> solution. However, in this case, the <code>purrr</code> solution requires a lot less code <em>around</em> the analysis code. And, in my personal opinion, the <code>purrr</code> code is easier to read.</p>
<p>If we didn’t want to type our column names in quotes, we could use tidy evaluation again. All we have to do is pass the column names to the <code>quos()</code> function in the <code>.x</code> argument and change the <code>.data[[x]]</code> being passed to the <code>count()</code> function to <code>{{ x }}</code> like this:</p>
<div class="sourceCode" id="cb1678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1678-1"><a href="using-the-purrr-package.html#cb1678-1" tabindex="-1"></a><span class="fu">map_dfr</span>(</span>
<span id="cb1678-2"><a href="using-the-purrr-package.html#cb1678-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">quos</span>(age_group, gender, bmi_3cat), <span class="co"># Change c() to quos()</span></span>
<span id="cb1678-3"><a href="using-the-purrr-package.html#cb1678-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb1678-4"><a href="using-the-purrr-package.html#cb1678-4" tabindex="-1"></a>    study <span class="sc">%&gt;%</span> </span>
<span id="cb1678-5"><a href="using-the-purrr-package.html#cb1678-5" tabindex="-1"></a>      <span class="fu">count</span>({{ x }}) <span class="sc">%&gt;%</span> <span class="co"># Change .data[[x]] to {{ x }}</span></span>
<span id="cb1678-6"><a href="using-the-purrr-package.html#cb1678-6" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1678-7"><a href="using-the-purrr-package.html#cb1678-7" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1678-8"><a href="using-the-purrr-package.html#cb1678-8" tabindex="-1"></a>      <span class="fu">select</span>(variable, category, n)</span>
<span id="cb1678-9"><a href="using-the-purrr-package.html#cb1678-9" tabindex="-1"></a>  }</span>
<span id="cb1678-10"><a href="using-the-purrr-package.html#cb1678-10" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;fct&gt;           &lt;int&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>And as before, we’d probably like to be able to use this code with other data frames too. So, we will once again replace a hard-coded data frame by adding a <code>data</code> argument to our function:</p>
<div class="sourceCode" id="cb1680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1680-1"><a href="using-the-purrr-package.html#cb1680-1" tabindex="-1"></a><span class="fu">map_dfr</span>(</span>
<span id="cb1680-2"><a href="using-the-purrr-package.html#cb1680-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">quos</span>(age_group, gender, bmi_3cat),</span>
<span id="cb1680-3"><a href="using-the-purrr-package.html#cb1680-3" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(x, <span class="at">data =</span> study) {</span>
<span id="cb1680-4"><a href="using-the-purrr-package.html#cb1680-4" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="co"># Don&#39;t forget to replace &quot;study&quot; with &quot;data&quot; here too!</span></span>
<span id="cb1680-5"><a href="using-the-purrr-package.html#cb1680-5" tabindex="-1"></a>      <span class="fu">count</span>({{ x }}) <span class="sc">%&gt;%</span> </span>
<span id="cb1680-6"><a href="using-the-purrr-package.html#cb1680-6" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1680-7"><a href="using-the-purrr-package.html#cb1680-7" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1680-8"><a href="using-the-purrr-package.html#cb1680-8" tabindex="-1"></a>      <span class="fu">select</span>(variable, category, n)</span>
<span id="cb1680-9"><a href="using-the-purrr-package.html#cb1680-9" tabindex="-1"></a>  }</span>
<span id="cb1680-10"><a href="using-the-purrr-package.html#cb1680-10" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;fct&gt;           &lt;int&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>And that concludes the chapter! I don’t blame you if you feel a little bit like your head is swimming at this point. It was a lot to take in! As I said at the end of the for loop chapter, I don’t recommend trying to memorize everything we covered in this chapter. Instead, I recommend that you read it until you sort of get the general idea of the <code>purrr</code> package and when it might be useful. Then, refer back to this chapter, or other online references that discuss the <code>purrr</code> package (there are many good ones out there), if you find yourself in a situation where you believe that the <code>purrr</code> package might be the right tool to help you complete a given programming task.</p>
<p>If you feel as though you want to take a deeper dive into the <code>purrr</code> package right away, then I suggest checking out the <a href="https://r4ds.had.co.nz/iteration.html#for-loops-vs.functionals">iteration chapter of R for Data Science</a>. For an even deeper dive, I recommend reading the <a href="https://adv-r.hadley.nz/functionals.html">functionals chapter of Advanced R</a>.</p>
<p>This concludes the repeated operations part of the book. If you aren’t feeling totally comfortable with the material we covered in this part of the book right now, that’s ok. I honestly wouldn’t expect you to yet. It takes <em>time</em> and <em>practice</em> for most people to be able to wrap their head around repeated operations. I think you are on track at this point as long as you understand why unnecessary repetition in your code is generally something you want to avoid. Then, slowly start using any of the methods <em>you feel most comfortable with</em> to remove the unnecessary repetition from your code. Start by doing so in very simple cases and gradually work your way up to more complicated cases. With some practice, you may eventually think this stuff is even fun!</p>

</div>
</div>
</div>




</div>
            </section>

          </div>
        </div>
      </div>
<a href="writing-for-loops.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-git-and-github.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/brad-cannell/r4epi/edit/master/chapters/07_part_repeated_operations/05_using_purrr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
